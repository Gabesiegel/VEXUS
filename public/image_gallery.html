<!DOCTYPE HTML>
<html lang="en">
<head>
    <title>Image Gallery - VExUS ATLAS</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    
    <!-- Initial visibility control -->
    <style>
    body {
        opacity: 0;
        transition: opacity 0.3s ease;
    }
    </style>
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        document.body.style.opacity = '1';
        // Initialize menu toggle after DOM is ready
        if (typeof initializeMenuToggle === 'function') {
            initializeMenuToggle();
        }
    });
    </script>
    
    <!-- CSS -->
    <link rel="stylesheet" href="html5up-phantom/assets/css/main.css" />
    <link rel="stylesheet" href="html5up-phantom/assets/css/fontawesome-all.min.css" />
    <link rel="stylesheet" href="html5up-phantom/assets/css/header.css" />
    <link rel="stylesheet" href="html5up-phantom/assets/css/sidebar.css" />
    <link rel="stylesheet" href="html5up-phantom/assets/css/logo.css" />
    <link rel="stylesheet" href="html5up-phantom/assets/css/fancybox-improvements.css" />
    <noscript><link rel="stylesheet" href="html5up-phantom/assets/css/noscript.css" /></noscript>

    <style>
        .container {
            width: 100%;
            max-width: 1400px;
            background: #fff;
            padding: 60px;
            margin: 20px auto;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        .logo-container {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 60px;
            margin-bottom: 2em;
            flex-wrap: wrap;
        }
        .logo {
            width: 500px;
            height: 250px;
            object-fit: contain;
        }
        .sidebar-logo {
            width: 100px;
            height: auto;
            margin-bottom: 0;
            padding: 5px;
        }
        /* Menu Navigation Styles - REMOVED (now using sidebar.css) */

        .title-container {
            text-align: center;
            margin: 2em 0;
        }
        .title-container h1 {
            font-size: 3.5em;
            margin-bottom: 0.2em;
        }

        /* Gallery Grid Styles */
        .gallery-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .gallery-item {
            background: #fff;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            cursor: pointer;
        }

        .gallery-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.12);
        }

        .gallery-item img {
            width: 100%;
            height: 180px;
            object-fit: cover;
            border-radius: 15px 15px 0 0;
            transition: all 0.3s ease;
        }

        .gallery-item:hover img {
            transform: scale(1.05);
        }

        .gallery-item-content {
            padding: 15px;
        }

        .gallery-item h3 {
            margin: 0 0 8px 0;
            font-size: 1.3em;
            color: #333;
            font-weight: 600;
        }

        .gallery-item .caption {
            color: #666;
            font-size: 0.9em;
            margin-bottom: 10px;
        }

        .gallery-item-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 12px;
        }

        .gallery-tag {
            font-size: 0.8em;
            padding: 4px 10px;
            border-radius: 12px;
            background: #f5f5f5;
            color: #555;
            font-weight: 500;
        }

        .gallery-tag.quality {
            background: #e3f2fd;
            color: #1976d2;
        }

        .gallery-tag.vein {
            background: #f3e5f5;
            color: #7b1fa2;
        }

        .gallery-tag.waveform {
            background: #e8f5e9;
            color: #2e7d32;
        }

        /* Modal Improvements */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch; /* Enable smooth scrolling on iOS */
            backdrop-filter: blur(5px);
            background-color: rgba(0,0,0,0.85);
            transition: all 0.3s ease;
            opacity: 0;
        }

        .modal.show {
            opacity: 1;
        }

        .modal-content {
            position: relative;
            margin: 40px auto;
            padding: 40px;
            background: #fff;
            border-radius: 20px;
            box-shadow: 0 4px 30px rgba(0,0,0,0.15);
            width: 100%;
            max-width: 1200px;
            overflow-y: visible;
            transform: translateY(20px);
            opacity: 0;
            transition: all 0.3s ease;
        }

        .modal.show .modal-content {
            transform: translateY(0);
            opacity: 1;
        }

        .modal-header-container {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            width: 100%;
            margin-bottom: 20px;
        }

        .modal-left-section {
            flex: 1;
        }

        .modal-title {
            font-size: 2em;
            color: #333;
            margin: 0;
            font-weight: 600;
        }

        .close {
            position: absolute;
            top: 20px;
            left: 40px; /* Move to left side with good padding */
            right: auto; /* Remove right positioning */
            width: 40px;
            height: 40px;
            background: transparent; /* Much more transparent */
            border: none; /* Subtle border */
            backdrop-filter: blur(4px); /* Modern blur effect */
            -webkit-backdrop-filter: blur(4px); /* For Safari support */
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            color: #777; /* Changed from white to grey */
            font-size: 24px;
            z-index: 1000;
        }

        .close:hover {
            background: transparent;
            transform: rotate(90deg) scale(1.1);
            border: none;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            color: #777; /* Keep grey on hover instead of white */
        }

        .prev, .next {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            width: 50px;
            height: 50px;
            background: rgba(255,255,255,0.9);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
            z-index: 1000;
        }

        .prev {
            left: 20px;
        }

        .next {
            right: 20px;
        }

        .prev:hover, .next:hover {
            background: #fff;
            transform: translateY(-50%) scale(1.1);
        }

        /* Sub-tiles modernization */
        .sub-tiles {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
            padding: 20px 0;
        }

        .sub-tile {
            background: #fff;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
            transition: all 0.3s ease;
            position: relative;
            cursor: pointer;
            border: 1px solid #eee;
        }

        .sub-tile:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.12);
            border-color: #ddd;
        }

        .sub-tile img {
            width: 100%;
            height: 200px;
            object-fit: cover;
            transition: all 0.3s ease;
        }

        .sub-tile:hover img {
            transform: scale(1.05);
        }

        .sub-tile p {
            padding: 12px;
            margin: 0;
            font-size: 1em;
            color: #333;
            text-align: center;
            font-weight: 500;
        }

        /* Modal breadcrumb styles */
        .modal-breadcrumb {
            margin-bottom: 15px;
            font-size: 0.9em;
            color: #666;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .modal-breadcrumb span {
            cursor: pointer;
            transition: color 0.2s ease;
        }

        .modal-breadcrumb span:hover {
            color: #333;
            text-decoration: underline;
        }

        .modal-breadcrumb .separator {
            margin: 0;
            color: #999;
            cursor: default;
        }

        .back-button {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 8px 15px;
            background: #f5f5f5;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9em;
            transition: all 0.2s ease;
            color: #555;
            flex-direction: row-reverse; /* Reverse icon and text order */
        }

        .back-button:hover {
            background: #eee;
            transform: translateX(2px); /* Change direction of hover animation */
        }

        .back-button i {
            font-size: 0.9em;
            transform: rotate(180deg); /* Flip the arrow to point right */
        }

        /* Severity tags */
        .severity-tag {
            position: absolute;
            top: 15px;
            right: 15px;
            padding: 6px 12px;
            border-radius: 15px;
            font-size: 0.8em;
            font-weight: 600;
            z-index: 1;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .severity-tag.normal {
            background: #e3f2fd;
            color: #1976d2;
        }

        .severity-tag.mild {
            background: #fff3e0;
            color: #e65100;
        }

        .severity-tag.severe {
            background: #ffebee;
            color: #c62828;
        }

        /* Fix for sub-modals */
        #hepaticNormalModal .modal-content,
        #hepaticMildModal .modal-content,
        #hepaticSevereModal .modal-content,
        #portalNormalModal .modal-content,
        #portalMildModal .modal-content,
        #portalSevereModal .modal-content,
        #renalNormalModal .modal-content,
        #renalMildModal .modal-content,
        #renalSevereModal .modal-content {
            background: #fff;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 4px 30px rgba(0,0,0,0.15);
        }

        /* Slideshow content styling */
        .slideshow-content {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            width: 100%;
            margin: 20px 0;
        }
        
        .slideshow-content img {
            max-width: 100%;
            max-height: 70vh;
            border-radius: 15px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            display: none;
            object-fit: contain;
            transition: opacity 0.3s ease;
        }

        .image-description {
            margin-top: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            width: 100%;
            text-align: center;
            font-size: 1.1em;
            color: #333;
            display: none;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        @media screen and (max-width: 768px) {
            .modal-content {
                margin: 20px;
                padding: 20px;
                width: calc(100% - 40px); /* Account for margins */
            }
            
            .modal {
                -webkit-overflow-scrolling: touch; /* Ensure smooth scrolling on iOS */
            }

            .sub-tiles {
                grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
                gap: 15px;
            }

            .sub-tile img {
                height: 140px;
            }

            .prev, .next {
                width: 40px;
                height: 40px;
            }

            .severity-tag {
            top: 10px;
            right: 10px;
                padding: 4px 8px;
            }

            .image-description {
                font-size: 1em;
                padding: 10px;
                margin-top: 15px;
            }
        }

        /* Filter System Styles */
        .filter-container {
            background: #fff;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
            margin-bottom: 30px;
        }

        .filter-title {
            font-size: 1.5em;
            color: #333;
            margin-bottom: 20px;
            font-weight: 600;
        }

        .filter-groups {
            display: flex;
            flex-wrap: wrap;
            gap: 25px;
        }

        .filter-group {
            flex: 1;
            min-width: 200px;
        }

        .filter-group-title {
            font-size: 1.1em;
            color: #555;
            margin-bottom: 12px;
            font-weight: 500;
        }

        .tag-container {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .tag {
            font-size: 0.9em;
            padding: 6px 12px;
            border-radius: 20px;
            background: #f5f5f5;
            color: #555;
            cursor: pointer;
            transition: all 0.2s ease;
            border: 2px solid transparent;
        }

        .tag:hover {
            background: #eee;
            transform: translateY(-1px);
        }

        .tag.active {
            background: #e3f2fd;
            color: #1976d2;
            border-color: #1976d2;
        }

        .active-filters {
            margin-top: 20px;
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            align-items: center;
        }

        .active-filter {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 4px 10px;
            background: #e3f2fd;
            color: #1976d2;
            border-radius: 15px;
            font-size: 0.9em;
        }

        .active-filter .remove {
            cursor: pointer;
            font-weight: bold;
            padding: 0 2px;
        }
        .active-filter .remove:hover {
            color: #1565c0;
        }

        .clear-filters {
            color: #666;
            cursor: pointer;
            font-size: 0.9em;
            text-decoration: underline;
            margin-left: auto;
        }

        .clear-filters:hover {
            color: #333;
        }

        /* Consistent tag colors */
        .tag[data-tag="high"],
        .tag[data-tag="medium"],
        .tag[data-tag="low"] {
            background: #e3f2fd;
            color: #1976d2;
        }

        .tag[data-tag="high"].active,
        .tag[data-tag="medium"].active,
        .tag[data-tag="low"].active {
            background: #bbdefb;
            border-color: #1976d2;
        }

        .tag[data-tag="ivc"],
        .tag[data-tag="hepatic"],
        .tag[data-tag="portal"],
        .tag[data-tag="renal"] {
            background: #f3e5f5;
            color: #7b1fa2;
        }

        .tag[data-tag="ivc"].active,
        .tag[data-tag="hepatic"].active,
        .tag[data-tag="portal"].active,
        .tag[data-tag="renal"].active {
            background: #e1bee7;
            border-color: #7b1fa2;
        }

        .tag[data-tag="normal"],
        .tag[data-tag="mild"],
        .tag[data-tag="severe"] {
            background: #e8f5e9;
            color: #2e7d32;
        }

        .tag[data-tag="normal"].active,
        .tag[data-tag="mild"].active,
        .tag[data-tag="severe"].active {
            background: #c8e6c9;
            border-color: #2e7d32;
        }

        /* Modal filter consistency */
        .modal-filters .tag-container {
            margin-bottom: 20px;
        }

        .modal-filters .tag {
            font-size: 0.9em;
            padding: 6px 12px;
        }

        @media screen and (max-width: 768px) {
            .filter-groups {
                gap: 15px;
            }
            
            .filter-group {
                min-width: 100%;
            }
            
            .tag {
                font-size: 0.85em;
                padding: 5px 10px;
            }
        }

        /* Gallery Submission Form Styles */
        .form-container {
            margin-top: 2em;
        }

        .fields {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 2em;
            margin-bottom: 2em;
        }

        .field {
            grid-column: span 2;
        }

        .field.half {
            grid-column: span 1;
        }

        .field input[type="text"],
        .field input[type="email"],
        .field textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            background: #f8f9fa;
            color: #333;
            font-family: inherit;
            transition: all 0.3s ease;
        }

        .field input[type="text"]:focus,
        .field input[type="email"]:focus,
        .field textarea:focus {
            border-color: #4a4a4a;
            background: #fff;
            box-shadow: 0 0 0 2px rgba(74, 74, 74, 0.1);
        }

        .upload-area {
            border: 2px dashed #ccc;
            border-radius: 8px;
            padding: 2em;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background: #f8f9fa;
        }

        .upload-area:hover {
            border-color: #4a4a4a;
            background: #fff;
        }

        .upload-icon {
            font-size: 2em;
            color: #666;
            margin-bottom: 0.5em;
        }

        .upload-text {
            color: #666;
            margin: 0;
        }

        .file-input {
            display: none;
        }

        .image-preview-container {
            margin-top: 1em;
            position: relative;
        }

        .image-preview {
            max-width: 100%;
            border-radius: 4px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .image-preview-controls {
            position: absolute;
            top: 10px;
            right: 10px;
        }

        .image-preview-delete {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 30px;
            height: 30px;
            background: rgba(255,255,255,0.9);
            border-radius: 50%;
            cursor: pointer;
            font-size: 20px;
            color: #666;
            transition: all 0.2s ease;
        }

        .image-preview-delete:hover {
            background: #fff;
            color: #333;
            transform: scale(1.1);
        }

        .actions {
            list-style: none;
            padding: 0;
            margin: 0;
            width: 100%;
        }

        .actions li {
            display: block;
            margin: 0;
            width: 100%;
        }

        input[type="submit"].primary {
            background: #888888;
            color: #fff;
            padding: 12px 30px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            width: 100%;
            display: block;
        }

        input[type="submit"].primary:hover {
            background: #666666;
            transform: translateY(-2px);
        }

        .success-message,
        .error-message {
            display: none;
            padding: 1em;
            margin-top: 1em;
            border-radius: 4px;
            text-align: center;
        }

        .success-message {
            background: #e8f5e9;
            color: #2e7d32;
            border: 1px solid #a5d6a7;
        }

        .error-message {
            background: #ffebee;
            color: #c62828;
            border: 1px solid #ef9a9a;
        }

        @media screen and (max-width: 768px) {
            .fields {
                grid-template-columns: 1fr;
                gap: 1em;
            }

            .field.half {
                grid-column: span 2;
            }
        }

        /* Update the close button position for sub-modals specifically */
        #ivcLessModal .close,
        #ivcMoreModal .close,
        #hepaticNormalModal .close,
        #hepaticMildModal .close, 
        #hepaticSevereModal .close,
        #renalNormalModal .close,
        #renalMildModal .close,
        #renalSevereModal .close {
            left: 40px; /* Move to left side with consistent 40px padding */
            right: auto; /* Remove right positioning */
            top: 80px; /* Keep the same vertical position */
        }
        
        /* Position the close button lower for Portal vein modals specifically */
        #portalNormalModal .close,
        #portalMildModal .close,
        #portalSevereModal .close {
            left: 40px; /* Move to left side with consistent 40px padding */
            right: auto; /* Remove right positioning */
            top: 120px; /* Keep the same vertical position */
        }
        
        
        /* Position the close button lower for Portal vein modals specifically */
        #portalNormalModal .close,
        #portalMildModal .close,
        #portalSevereModal .close {
            left: 20px; /* Move to left side */
            right: auto; /* Remove right positioning */
            top: 120px; /* Keep the same vertical position */
        }
        
        /* Make the close button in main vein modals match their respective sub-modals */
        #hepaticModal .close {
            left: 40px; /* Move to left side with consistent 40px padding */
            right: auto; /* Remove right positioning */
            top: 80px;
        }
        
        #renalModal .close {
            left: 40px; /* Move to left side with consistent 40px padding */
            right: auto; /* Remove right positioning */
            top: 80px;
        }
        
        #portalModal .close {
            left: 40px; /* Move to left side with consistent 40px padding */
            right: auto; /* Remove right positioning */
            top: 120px;
        }
    </style>
    <!-- Additional styles for menu functionality -->
    <style>
        /* Critical styles for menu visibility */
        body.is-menu-visible #menu {
            display: block !important;
            visibility: visible !important;
            right: 0 !important;
            z-index: 10000 !important;
        }
        
        #menu {
            transition: all 0.5s ease;
        }
        
        #menu.visible {
            display: block !important;
            visibility: visible !important;
            right: 0 !important;
        }
        
        /* Increase z-index for menu toggle button */
        a[href="#menu"] {
            z-index: 9000 !important;
            position: relative !important;
        }
        
        /* Ensure menu appears above other elements */
        nav#menu {
            z-index: 10000 !important;
        }
    </style>
    <!-- Critical styles for menu visibility -->
    <style>
        /* Critical styles for menu visibility */
        body.is-menu-visible #menu {
            display: block !important;
            visibility: visible !important;
            right: 0 !important;
            z-index: 10000 !important;
        }
        
        #menu {
            transition: all 0.5s ease;
            position: fixed !important;
            top: 0 !important;
            height: 100% !important;
            width: 300px !important;
            max-width: 80% !important;
            right: -300px !important;
            z-index: 10000 !important;
            overflow-y: auto !important;
        }
        
        #menu.visible {
            display: block !important;
            visibility: visible !important;
            right: 0 !important;
        }
        
        /* Increase z-index for menu toggle button */
        a[href="#menu"] {
            z-index: 9000 !important;
            position: relative !important;
        }
        
        /* Ensure menu appears above other elements */
        nav#menu {
            z-index: 10000 !important;
        }
    </style>

    <style>
        /* Remove tap highlight color */
        * {
            -webkit-tap-highlight-color: transparent;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            user-select: none;
        }

        /* Remove focus outline */
        .modal *:focus {
            outline: none !important;
        }

        .modal *:active {
            background-color: transparent !important;
        }

        .gallery-item,
        .sub-tile,
        .close,
        .back-button,
        .prev,
        .next,
        .modal-breadcrumb span,
        .tag {
            -webkit-tap-highlight-color: transparent;
            outline: none !important;
        }

        .image-description {
            -webkit-user-select: text;
            user-select: text;
        }

        #menu {
            transition: all 0.5s ease;
        }
    </style>

    <style>
        [data-fancybox-loaded="true"] {
            visibility: visible !important;
            opacity: 1 !important;
        }
        
        /* Mobile optimization enhancements */
        @media screen and (max-width: 736px) {
            /* Increase touch target sizes for mobile */
            nav#menu ul li a {
                padding: 12px 0;
                font-size: 1em;
            }
            
            a[href="#menu"] {
                width: 44px;
                height: 44px;
                display: flex;
                align-items: center;
                justify-content: center;
            }
            
            /* Adjust spacing in sections */
            .waveform-section, .content-section, .section {
                padding: 20px 15px;
                margin-bottom: 25px;
            }
            
            h2 {
                font-size: 1.4em;
                padding-bottom: 8px;
                margin-bottom: 15px;
            }
            
            h3 {
                font-size: 1.2em;
                margin-top: 15px;
                margin-bottom: 10px;
            }
            
            /* Make lists more readable on mobile */
            ul, ol {
                margin-left: 15px;
                margin-bottom: 15px;
            }
            
            li {
                margin-bottom: 8px;
                line-height: 1.5;
                font-size: 0.95em;
            }
            
            /* Improve image tiles on mobile */
            .image-tile, .gallery-tile, .article-tile, .team-tile {
                padding: 15px;
                margin: 20px 0;
            }
            
            .title, .tile-title {
                font-size: 1.15em;
                margin-bottom: 8px;
            }
            
            .caption, .description {
                font-size: 0.95em;
                padding: 0 5px;
            }
            
            /* Adjust citation display on mobile */
            .citation {
                min-width: 18px;
                height: 18px;
                font-size: 0.75em;
                padding: 0 5px;
            }
            
            /* Better reference grid on mobile */
            .reference-grid, .grid, .gallery-grid, .team-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .reference-tile, .grid-item, .gallery-item {
                padding: 15px;
            }
            
            /* Main content adjustments */
            #main > .inner {
                padding: 20px 15px;
            }
            
            .container {
                padding: 1rem;
                margin: 1rem auto;
            }
            
            /* Improve Fancybox usability on mobile */
            .fancybox__button {
                width: 40px !important;
                height: 40px !important;
            }
            
            .fancybox__caption {
                font-size: 0.9em !important;
                padding: 8px 12px !important;
            }
        }
        
        @media screen and (max-width: 480px) {
            /* Further optimizations for very small screens */
            .waveform-section, .content-section, .section {
                padding: 15px 12px;
            }
            
            h2 {
                font-size: 1.3em;
            }
            
            h3 {
                font-size: 1.1em;
            }
            
            p, .image-tile .caption, .description {
                font-size: 0.9em;
                line-height: 1.5;
            }
            
            /* Make menu items even larger for small touch screens */
            nav#menu ul li a {
                padding: 14px 0;
                font-size: 1.1em;
            }
            
            /* Fix image display on very small screens */
            .image-tile img, .gallery-tile img {
                margin-bottom: 10px;
            }
            
            .citation {
                min-width: 16px;
                height: 16px;
                font-size: 0.7em;
                padding: 0 4px;
            }
            
            /* Stacked references on mobile */
            .reference-tile, .grid-item {
                padding: 12px;
            }
            
            .reference-title, .item-title {
                font-size: 0.95em;
            }
            
            .reference-authors, .reference-journal, .item-subtitle {
                font-size: 0.85em;
            }
            
            /* Better Fancybox controls for tiny screens */
            .fancybox__button {
                width: 36px !important;
                height: 36px !important;
            }
            
            /* Remove hover effects on mobile */
            .section:hover,
            .image-tile:hover,
            .gallery-tile:hover,
            .logo:hover,
            .sidebar-logo:hover,
            .reference-tile:hover,
            .team-tile:hover,
            .grid-item:hover {
                transform: none;
            }
        }
        
        /* Fix for menu closing on small screens */
        @media screen and (max-width: 736px) {
            #menu a.close {
                width: 44px;
                height: 44px;
                line-height: 44px;
                font-size: 1.25em;
            }
            
            #menu .inner {
                padding-top: 4.5em;
            }
        }
    </style>
</head>
<body class="is-preload">
    <div id="wrapper">
        <!-- Header (hamburger menu) -->
        <header id="header">
            <div class="inner">
                <!-- Logo -->
                <a href="index.html" class="logo">
                    <span class="symbol"><img src="./images/VEXUS.ATLAS.png" alt="" /></span>
                    <span class="title">VExUS ATLAS</span>
                </a>
                
                <nav>
                    <ul>
                        <li><a href="#menu">Menu</a></li>
                </nav>
            </div>
        </header>

        <!-- Sidebar Navigation -->
        <nav id="menu">
            <div class="inner">
                <div class="logo-container">
                    <img src="./images/VEXUS.ATLAS.png" alt="VExUS ATLAS Logo" class="sidebar-logo">
                </div>
                <h2>Menu</h2>
                <ul>
                    <li><a href="index.html">Home</a></li>
                    <li><a href="education.html">VEXUS Overview</a></li>
                    <li><a href="waveform.html">Waveforms</a></li>
                    <li><a href="calculator.html">AI Image Recognition</a></li>
                    <li><a href="acquisition.html">Image Acquisition Guide</a></li>
                    <li><a href="Publications.html">Publications</a></li>
                    <li><a href="literature_review.html">Literature Review</a></li>
                    <li><a href="image_gallery.html">Image Gallery</a></li>
                    <li><a href="about.html">About VExUS ATLAS</a></li>
                    <li><a href="our_team.html">Our Team</a></li>
                    <li><a href="contact.html">Contact</a></li>
                </ul>
            </div>
        </nav>

        <!-- Main Content -->
        <div id="main">
            <div class="inner">
                <div class="container">
                    <!-- Logos -->
                    <div class="logo-container">
                        <img src="./images/VEXUS.ATLAS.png" alt="VExUS ATLAS Logo" class="logo">
                    </div>
                    <!-- Title -->
                    <div class="title-container">
                        <h1>VExUS Image Gallery</h1>
                        <p>A collection of VExUS ultrasound images showcasing various grades and findings.</p>
                    </div>

                    <!-- Filter System -->
                    <div class="filter-container">
                        <h3 class="filter-title">Filter Images</h3>
                        <div class="filter-groups">
                            <div class="filter-group">
                                <div class="filter-group-title">Quality</div>
                                <div class="tag-container" data-filter-group="quality">
                                    <div class="tag" data-tag="high">High Quality</div>
                                    <div class="tag" data-tag="medium">Medium Quality</div>
                                    <div class="tag" data-tag="low">Low Quality</div>
                                </div>
                            </div>
                            <div class="filter-group">
                                <div class="filter-group-title">Vein Type</div>
                                <div class="tag-container" data-filter-group="vein">
                                    <div class="tag" data-tag="ivc">IVC</div>
                                    <div class="tag" data-tag="hepatic">Hepatic</div>
                                    <div class="tag" data-tag="portal">Portal</div>
                                    <div class="tag" data-tag="renal">Renal</div>
                                </div>
                            </div>
                            <div class="filter-group">
                                <div class="filter-group-title">Waveform</div>
                                <div class="tag-container" data-filter-group="waveform">
                                    <div class="tag" data-tag="normal">Normal</div>
                                    <div class="tag" data-tag="mild">Mild</div>
                                    <div class="tag" data-tag="severe">Severe</div>
                                </div>
                            </div>
                        </div>
                        <div class="active-filters">
                            <span class="clear-filters">Clear all filters</span>
                        </div>
                    </div>

                    <!-- Gallery Grid -->
                    <div class="gallery-grid">
                        <!-- IVC Tile -->
                        <div class="gallery-item" data-target-modal="ivcModal" 
                             data-quality="high" data-vein="ivc" data-waveform="normal">
                            <img src="images/IVC_icon.jpeg" alt="IVC Thumbnail">
                            <div class="gallery-item-content">
                            <h3>IVC</h3>
                            <p class="caption">Tap to view details</p>
                                <div class="gallery-item-tags">
                                    <span class="gallery-tag quality">Quality</span>
                                    <span class="gallery-tag vein">IVC</span>
                                    <span class="gallery-tag waveform">All Types</span>
                                </div>
                            </div>
                        </div>
                        <!-- Hepatic Vein Tile -->
                        <div class="gallery-item" data-target-modal="hepaticModal"
                             data-quality="high" data-vein="hepatic" data-waveform="normal,mild,severe">
                            <img src="images/hepatic_icon.jpeg" alt="Hepatic Vein Thumbnail">
                            <div class="gallery-item-content">
                            <h3>Hepatic Vein</h3>
                            <p class="caption">Tap to view Mild/Normal/Severe</p>
                                <div class="gallery-item-tags">
                                    <span class="gallery-tag quality">Quality</span>
                                    <span class="gallery-tag vein">Hepatic</span>
                                    <span class="gallery-tag waveform">All Types</span>
                                </div>
                            </div>
                        </div>
                        <!-- Portal Vein Tile -->
                        <div class="gallery-item" data-target-modal="portalModal"
                             data-quality="high" data-vein="portal" data-waveform="normal,mild,severe">
                            <img src="images/portal_icon.png" alt="Portal Vein Thumbnail">
                            <div class="gallery-item-content">
                            <h3>Portal Vein</h3>
                            <p class="caption">Tap to view Mild/Normal/Severe</p>
                                <div class="gallery-item-tags">
                                    <span class="gallery-tag quality">Quality</span>
                                    <span class="gallery-tag vein">Portal</span>
                                    <span class="gallery-tag waveform">All Types</span>
                                </div>
                            </div>
                        </div>
                        <!-- Renal Vein Tile -->
                        <div class="gallery-item" data-target-modal="renalModal"
                             data-quality="high" data-vein="renal" data-waveform="normal,mild,severe">
                            <img src="images/renal_icon.png" alt="Renal Vein Thumbnail">
                            <div class="gallery-item-content">
                            <h3>Renal Vein</h3>
                            <p class="caption">Tap to view Mild/Normal/Severe</p>
                                <div class="gallery-item-tags">
                                    <span class="gallery-tag quality">Quality</span>
                                    <span class="gallery-tag vein">Renal</span>
                                    <span class="gallery-tag waveform">All Types</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Gallery Submission Section -->
                    <div class="container" style="margin-top: 40px;">
                        <header>
                        <h2>Want Your VExUS Image Featured in the Gallery?</h2>
                            <p>Share your high-quality VExUS ultrasound images with the community. Selected images will be featured in our gallery to help educate others.</p>
                        </header>

                        <div class="form-container">
                            <form id="gallerySubmissionForm" method="post" action="#">
                                <div class="fields">
                                    <div class="field half">
                                        <input type="email" id="gallery_email" name="email" placeholder="Email" required />
                                    </div>
                                    <div class="field half">
                                        <input type="text" id="gallery_institution" name="institution" placeholder="Institution" required />
                                    </div>
                                    <div class="field">
                                        <input type="text" id="gallery_title" name="title" placeholder="Title" required />
                                    </div>
                                    <div class="field">
                                        <textarea id="gallery_description" name="description" placeholder="Please provide details about the image, including the VExUS grade, clinical context, and any interesting findings." rows="6" required></textarea>
                                    </div>
                                    <div class="field">
                                <div class="upload-area" id="galleryUploadArea">
                                    <i class="fas fa-cloud-upload-alt upload-icon"></i>
                                    <p class="upload-text">Click or drag and drop your VExUS image here</p>
                                    <input type="file" id="galleryImageInput" class="file-input" accept="image/*" />
                                </div>
                                <div class="image-preview-container" style="display: none;">
                                    <img id="galleryImagePreview" class="image-preview" alt="Image preview" />
                                    <div class="image-preview-controls">
                                        <span class="image-preview-delete" onclick="resetGalleryImageUpload()">Ã—</span>
                                    </div>
                                </div>
                                    </div>
                                </div>
                                <div class="actions">
                                    <input type="submit" value="Submit for VExUS ATLAS" class="primary" />
                                </div>
                            </form>
                            <div class="success-message">Thank you! Your image has been submitted for review.</div>
                            <div class="error-message">Sorry, there was an error submitting your image. Please try again.</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- IVC Modal -->
        <div id="ivcModal" class="modal">
            <span class="close">&times;</span>
            <div class="modal-content">
                <div class="modal-header-container">
                    <div class="modal-left-section">
                        <div class="modal-breadcrumb">
                            <span>IVC</span>
                        </div>
                        <div class="modal-header">
                            <h2 class="modal-title">IVC Ultrasound</h2>
                        </div>
                    </div>
                    <div class="back-button">
                        <i class="fas fa-arrow-left"></i> Back to Gallery
                    </div>
                </div>
                <div class="sub-tiles">
                    <div class="sub-tile" data-target-modal="ivcLessModal" data-severity="less">
                        <span class="severity-tag normal">< 2cm</span>
                        <img src="images/image_gallery/IVC/Less/01.01.1.IVC.NL.png" alt="IVC Less than 2cm">
                        <p>IVC Diameter < 2cm</p>
                    </div>
                    <div class="sub-tile" data-target-modal="ivcMoreModal" data-severity="more">
                        <span class="severity-tag severe">> 2cm</span>
                        <img src="images/image_gallery/IVC/More/02.01.1.IVC.MD.png" alt="IVC More than 2cm">
                        <p>IVC Diameter > 2cm</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- IVC Sub-modals -->
        <div id="ivcLessModal" class="modal">
            <span class="close">&times;</span>
            <div class="modal-content">
                <div class="modal-header-container">
                    <div class="modal-left-section">
                        <div class="modal-breadcrumb">
                            <span data-target-modal="ivcModal">IVC</span>
                            <span class="separator">/</span>
                            <span>< 2cm</span>
                        </div>
                    </div>
                    <div class="back-button" data-parent-modal="ivcModal">
                        <i class="fas fa-arrow-left"></i> Back to IVC
                    </div>
                </div>
                <div class="slideshow-content ivcLessSlides">
                    <img src="images/image_gallery/IVC/Less/01.01.1.IVC.NL.png" alt="IVC Less than 2cm Image" />
                    <div class="image-description">IVC diameter measuring less than 2cm, indicating potential volume responsiveness.</div>
                </div>
                <span class="prev" data-slideshow="ivcLessSlides" data-direction="-1">&#10094;</span>
                <span class="next" data-slideshow="ivcLessSlides" data-direction="1">&#10095;</span>
            </div>
        </div>

        <div id="ivcMoreModal" class="modal">
            <span class="close">&times;</span>
            <div class="modal-content">
                <div class="modal-header-container">
                    <div class="modal-left-section">
                        <div class="modal-breadcrumb">
                            <span data-target-modal="ivcModal">IVC</span>
                            <span class="separator">/</span>
                            <span>> 2cm</span>
                        </div>
                    </div>
                    <div class="back-button" data-parent-modal="ivcModal">
                        <i class="fas fa-arrow-left"></i> Back to IVC
                    </div>
                </div>
                <div class="slideshow-content ivcMoreSlides">
                    <img src="images/image_gallery/IVC/More/02.01.1.IVC.MD.png" alt="IVC More than 2cm Image" />
                    <div class="image-description">IVC diameter measuring greater than 2cm, suggesting potential fluid overload or right heart dysfunction.</div>
                </div>
                <span class="prev" data-slideshow="ivcMoreSlides" data-direction="-1">&#10094;</span>
                <span class="next" data-slideshow="ivcMoreSlides" data-direction="1">&#10095;</span>
            </div>
        </div>

        <!-- HEPATIC Vein Modal -->
        <div id="hepaticModal" class="modal">
            <span class="close" onclick="closeModal('hepaticModal')">&times;</span>
            <div class="modal-content">
                <div class="modal-header-container">
                    <div class="modal-left-section">
                        <div class="modal-breadcrumb">
                            <span onclick="openModal('hepaticModal')">Hepatic Vein</span>
                        </div>
                    </div>
                    <div class="back-button" onclick="closeModal('hepaticModal')">
                        <i class="fas fa-arrow-left"></i> Back to Gallery
                    </div>
                </div>
                <div class="sub-tiles">
                    <div class="sub-tile" data-target-modal="hepaticNormalModal" data-severity="normal">
                        <span class="severity-tag normal">Normal</span>
                        <img src="images/image_gallery/Hepatic/Normal/01.02.4.HV.NL.png" alt="Hepatic Normal">
                        <p>Normal Hepatic Flow</p>
                    </div>
                    <div class="sub-tile" data-target-modal="hepaticMildModal" data-severity="mild">
                        <span class="severity-tag mild">Mild</span>
                        <img src="images/image_gallery/Hepatic/Mild/02.0.2.HV.MD.png" alt="Hepatic Mild">
                        <p>Mild Abnormality</p>
                    </div>
                    <div class="sub-tile" data-target-modal="hepaticSevereModal" data-severity="severe">
                        <span class="severity-tag severe">Severe</span>
                        <img src="images/image_gallery/Hepatic/Severe/18.03.01.HV.SR.png" alt="Hepatic Severe">
                        <p>Severe Abnormality</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- HEPATIC Sub-modals -->
        <div id="hepaticNormalModal" class="modal">
            <span class="close" onclick="closeModal('hepaticNormalModal')">&times;</span>
            <div class="modal-content">
                <div class="modal-header-container">
                    <div class="modal-left-section">
                        <div class="modal-breadcrumb">
                            <span onclick="openModal('hepaticModal')">Hepatic Vein</span>
                            <span class="separator">/</span>
                            <span>Normal</span>
                        </div>
                    </div>
                    <div class="back-button" onclick="openModal('hepaticModal')">
                        <i class="fas fa-arrow-left"></i> Back to Hepatic Vein
                    </div>
                </div>
                <div class="slideshow-content hepaticNormalSlides">
                <img src="images/image_gallery/Hepatic/Normal/01.02.4.HV.NL.png" alt="Hepatic Normal Image" />
                    <div class="image-description">Normal hepatic vein waveform showing typical triphasic pattern with clear systolic and diastolic waves.</div>
                <img src="images/image_gallery/Hepatic/Normal/05.02.02.HV.NL.png" alt="Hepatic Normal Image 2" />
                    <div class="image-description">Another example of normal hepatic vein flow demonstrating consistent triphasic pattern.</div>
                </div>
                <span class="prev" onclick="plusSlides(-1, 'hepaticNormalSlides')">&#10094;</span>
                <span class="next" onclick="plusSlides(1, 'hepaticNormalSlides')">&#10095;</span>
            </div>
        </div>

        <div id="hepaticMildModal" class="modal">
            <span class="close" onclick="closeModal('hepaticMildModal')">&times;</span>
            <div class="modal-content">
                <div class="modal-header-container">
                    <div class="modal-left-section">
                        <div class="modal-breadcrumb">
                            <span onclick="openModal('hepaticModal')">Hepatic Vein</span>
                            <span class="separator">/</span>
                            <span>Mild</span>
                        </div>
                    </div>
                    <div class="back-button" onclick="openModal('hepaticModal')">
                        <i class="fas fa-arrow-left"></i> Back to Hepatic Vein
                    </div>
                </div>
                <div class="slideshow-content hepaticMildSlides">
                <img src="images/image_gallery/Hepatic/Mild/02.0.2.HV.MD.png" alt="Hepatic Mild Image" />
                    <div class="image-description">Mild hepatic vein abnormality showing decreased pulsatility with dampened systolic wave.</div>
                <img src="images/image_gallery/Hepatic/Mild/06.03.01.HV.MD.png" alt="Hepatic Mild Image 2" />
                    <div class="image-description">Mild congestion pattern with reduced but still present phasic flow.</div>
                </div>
                <span class="prev" onclick="plusSlides(-1, 'hepaticMildSlides')">&#10094;</span>
                <span class="next" onclick="plusSlides(1, 'hepaticMildSlides')">&#10095;</span>
            </div>
        </div>

        <div id="hepaticSevereModal" class="modal">
            <span class="close" onclick="closeModal('hepaticSevereModal')">&times;</span>
            <div class="modal-content">
                <div class="modal-header-container">
                    <div class="modal-left-section">
                        <div class="modal-breadcrumb">
                            <span onclick="openModal('hepaticModal')">Hepatic Vein</span>
                            <span class="separator">/</span>
                            <span>Severe</span>
                        </div>
                    </div>
                    <div class="back-button" onclick="openModal('hepaticModal')">
                        <i class="fas fa-arrow-left"></i> Back to Hepatic Vein
                    </div>
                </div>
                <div class="slideshow-content hepaticSevereSlides">
                    <img src="images/image_gallery/Hepatic/Severe/18.03.01.HV.SR.png" alt="Hepatic Severe Image" />
                    <div class="image-description">Severe hepatic congestion showing monophasic waveform with loss of normal triphasic pattern.</div>
                    <img src="images/image_gallery/Hepatic/Severe/18.03.01.HV.SR.png" alt="Hepatic Severe Image 2" />
                    <div class="image-description">Another example of severe hepatic congestion with continuous monophasic flow.</div>
                </div>
                <span class="prev" onclick="plusSlides(-1, 'hepaticSevereSlides')">&#10094;</span>
                <span class="next" onclick="plusSlides(1, 'hepaticSevereSlides')">&#10095;</span>
            </div>
        </div>

        <!-- RENAL Vein Modal -->
        <div id="renalModal" class="modal">
            <span class="close" onclick="closeModal('renalModal')">&times;</span>
            <div class="modal-content">
                <div class="modal-header-container">
                    <div class="modal-left-section">
                        <div class="modal-breadcrumb">
                            <span onclick="openModal('renalModal')">Renal Vein</span>
                        </div>
                    </div>
                    <div class="back-button" onclick="closeModal('renalModal')">
                        <i class="fas fa-arrow-left"></i> Back to Gallery
                    </div>
                </div>
                <div class="sub-tiles">
                    <div class="sub-tile" data-target-modal="renalNormalModal" data-severity="normal">
                        <span class="severity-tag normal">Normal</span>
                        <img src="images/image_gallery/Renal/Normal/01.03.1.RV.NL.png" alt="Renal Normal">
                        <p>Normal Renal Flow</p>
                    </div>
                    <div class="sub-tile" data-target-modal="renalMildModal" data-severity="mild">
                        <span class="severity-tag mild">Mild</span>
                        <img src="images/image_gallery/Renal/Mild/02.0.01.RV.MD.png" alt="Renal Mild">
                        <p>Mild Abnormality</p>
                    </div>
                    <div class="sub-tile" data-target-modal="renalSevereModal" data-severity="severe">
                        <span class="severity-tag severe">Severe</span>
                        <img src="images/image_gallery/Renal/Severe/61.0.2.RV.SR.png" alt="Renal Severe">
                        <p>Severe Abnormality</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- RENAL Sub-modals -->
        <div id="renalNormalModal" class="modal">
            <span class="close" onclick="closeModal('renalNormalModal')">&times;</span>
            <div class="modal-content">
                <div class="modal-header-container">
                    <div class="modal-left-section">
                        <div class="modal-breadcrumb">
                            <span onclick="openModal('renalModal')">Renal Vein</span>
                            <span class="separator">/</span>
                            <span>Normal</span>
                        </div>
                    </div>
                    <div class="back-button" onclick="openModal('renalModal')">
                        <i class="fas fa-arrow-left"></i> Back to Renal Vein
                    </div>
                </div>
                <div class="slideshow-content renalNormalSlides">
                    <img src="images/image_gallery/Renal/Normal/01.03.1.RV.NL.png" alt="Renal Normal Image" />
                    <div class="image-description">Normal renal vein flow pattern showing continuous flow with minimal phasicity.</div>
                </div>
            <span class="prev" onclick="plusSlides(-1, 'renalNormalSlides')">&#10094;</span>
            <span class="next" onclick="plusSlides(1, 'renalNormalSlides')">&#10095;</span>
            </div>
        </div>

        <div id="renalMildModal" class="modal">
            <span class="close" onclick="closeModal('renalMildModal')">&times;</span>
            <div class="modal-content">
                <div class="modal-header-container">
                    <div class="modal-left-section">
                        <div class="modal-breadcrumb">
                            <span onclick="openModal('renalModal')">Renal Vein</span>
                            <span class="separator">/</span>
                            <span>Mild</span>
                        </div>
                    </div>
                    <div class="back-button" onclick="openModal('renalModal')">
                        <i class="fas fa-arrow-left"></i> Back to Renal Vein
                    </div>
                </div>
                <div class="slideshow-content renalMildSlides">
                    <img src="images/image_gallery/Renal/Mild/02.0.01.RV.MD.png" alt="Renal Mild Image" />
                    <div class="image-description">Mild renal congestion with early signs of pulsatility in the normally continuous flow.</div>
                </div>
            <span class="prev" onclick="plusSlides(-1, 'renalMildSlides')">&#10094;</span>
            <span class="next" onclick="plusSlides(1, 'renalMildSlides')">&#10095;</span>
            </div>
        </div>

        <div id="renalSevereModal" class="modal">
            <span class="close" onclick="closeModal('renalSevereModal')">&times;</span>
            <div class="modal-content">
                <div class="modal-header-container">
                    <div class="modal-left-section">
                        <div class="modal-breadcrumb">
                            <span onclick="openModal('renalModal')">Renal Vein</span>
                            <span class="separator">/</span>
                            <span>Severe</span>
                        </div>
                    </div>
                    <div class="back-button" onclick="openModal('renalModal')">
                        <i class="fas fa-arrow-left"></i> Back to Renal Vein
                    </div>
                </div>
                <div class="slideshow-content renalSevereSlides">
                    <img src="images/image_gallery/Renal/Severe/61.0.2.RV.SR.png" alt="Renal Severe Image" />
                    <div class="image-description">Severe renal congestion demonstrating marked pulsatility and flow reversal.</div>
                </div>
            <span class="prev" onclick="plusSlides(-1, 'renalSevereSlides')">&#10094;</span>
            <span class="next" onclick="plusSlides(1, 'renalSevereSlides')">&#10095;</span>
            </div>
        </div>

        <!-- PORTAL Vein Modal -->
        <div id="portalModal" class="modal">
            <span class="close" onclick="closeModal('portalModal')">&times;</span>
            <div class="modal-content">
                <div class="modal-header-container">
                    <div class="modal-left-section">
                        <div class="modal-breadcrumb">
                            <span onclick="openModal('portalModal')">Portal Vein</span>
                        </div>
                    </div>
                    <div class="back-button" onclick="closeModal('portalModal')">
                        <i class="fas fa-arrow-left"></i> Back to Gallery
                    </div>
                </div>
                <div class="sub-tiles">
                    <div class="sub-tile" data-target-modal="portalNormalModal" data-severity="normal">
                        <span class="severity-tag normal">Normal</span>
                        <img src="images/image_gallery/Portal_Vein/Normal/01.1.2.PV.NL.png" alt="Portal Normal">
                        <p>Normal Portal Flow</p>
                    </div>
                    <div class="sub-tile" data-target-modal="portalMildModal" data-severity="mild">
                        <span class="severity-tag mild">Mild</span>
                        <img src="images/image_gallery/Portal_Vein/Mild/01.0.1.PV.MD.png" alt="Portal Mild">
                        <p>Mild Abnormality</p>
                    </div>
                    <div class="sub-tile" data-target-modal="portalSevereModal" data-severity="severe">
                        <span class="severity-tag severe">Severe</span>
                        <img src="images/image_gallery/Portal_Vein/Severe/09.01.01.PV.SR.png" alt="Portal Severe">
                        <p>Severe Abnormality</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- PORTAL Sub-modals -->
        <div id="portalNormalModal" class="modal">
            <span class="close" onclick="closeModal('portalNormalModal')">&times;</span>
            <div class="modal-content">
                <div class="modal-header-container">
                    <div class="modal-left-section">
                        <div class="modal-breadcrumb">
                            <span onclick="openModal('portalModal')">Portal Vein</span>
                            <span class="separator">/</span>
                            <span>Normal</span>
                        </div>
                    </div>
                    <div class="back-button" onclick="openModal('portalModal')">
                        <i class="fas fa-arrow-left"></i> Back to Portal Vein
                    </div>
                </div>
                <div class="slideshow-content portalNormalSlides">
                <span class="prev" onclick="plusSlides(-1, 'portalMildSlides')">&#10094;</span>
                <span class="next" onclick="plusSlides(1, 'portalMildSlides')">&#10095;</span>
            </div>
        </div>

        <div id="portalSevereModal" class="modal">
            <span class="close" onclick="closeModal('portalSevereModal')">&times;</span>
            <div class="modal-content">
                <div class="modal-breadcrumb">
                    <span onclick="openModal('portalModal')">Portal Vein</span>
                    <span class="separator">/</span>
                    <span>Severe</span>
                </div>
                <div class="back-button" onclick="openModal('portalModal')">
                    <i class="fas fa-arrow-left"></i> Back to Portal Vein
                </div>
                <div class="slideshow-content portalSevereSlides">
                    <img src="images/image_gallery/Portal_Vein/Severe/09.01.01.PV.SR.png" alt="Portal Severe Image" />
                </div>
                <span class="prev" onclick="plusSlides(-1, 'portalSevereSlides')">&#10094;</span>
                <span class="next" onclick="plusSlides(1, 'portalSevereSlides')">&#10095;</span>
            </div>
        </div>
    </div>
    
    <!-- Scripts -->
    <script src="html5up-phantom/assets/js/jquery.min.js"></script>
    <script src="html5up-phantom/assets/js/browser.min.js"></script>
    <script src="html5up-phantom/assets/js/breakpoints.min.js"></script>
    <script src="html5up-phantom/assets/js/util.js"></script>
    <script src="html5up-phantom/assets/js/main.js"></script>

    <script>
        // Global variables for modal and slideshow management
        let slideIndex = {};
        let currentModal = null;
        let modalStack = [];

        // Initialize all functionality when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM loaded - initializing gallery');
            
            // Remove inline onclick attributes
            removeInlineClickHandlers();
            
            // Set up components in correct order
            setupGalleryItems();
            setupSubTiles();
            setupModalControls();
            setupTagFiltering();
            setupGalleryUpload();
            setupModalFilters();
            
            console.log('Gallery initialization complete');
        });
        
        // Remove all inline onclick attributes to prevent conflicts
        function removeInlineClickHandlers() {
            document.querySelectorAll('[onclick]').forEach(element => {
                console.log(`Removing inline onclick from: ${element.tagName} - ${element.onclick}`);
                element.removeAttribute('onclick');
            });
        }

        // Setup gallery item click handlers
        function setupGalleryItems() {
            console.log('Setting up gallery items');
            document.querySelectorAll('.gallery-item').forEach(item => {
                // Find the modal ID from data attributes
                const modalId = item.getAttribute('data-target-modal');
                
                if (modalId) {
                    console.log(`Setting up gallery item for modal: ${modalId}`);
                    
                    // Remove any existing click listeners
                    const newItem = item.cloneNode(true);
                    item.parentNode.replaceChild(newItem, item);
                    
                    // Add new click handler with debugging
                    newItem.addEventListener('click', function(e) {
                        e.preventDefault();
                        e.stopPropagation();
                        console.log(`Gallery item clicked, opening: ${modalId}`);
                        openModal(modalId);
                    });
                } else {
                    console.warn('Gallery item missing data-target-modal attribute:', item);
                }
            });
        }

        // Setup sub-tile click handlers
        function setupSubTiles() {
            console.log('Setting up sub-tiles');
            document.querySelectorAll('.sub-tile').forEach(tile => {
                const targetModal = tile.getAttribute('data-target-modal');
                if (targetModal) {
                    console.log(`Setting up sub-tile for modal: ${targetModal}`);
                    
                    // Remove any existing click listeners
                    const newTile = tile.cloneNode(true);
                    tile.parentNode.replaceChild(newTile, tile);
                    
                    // Add direct click handler with the specific target modal
                    newTile.addEventListener('click', function(e) {
                        e.preventDefault();
                        e.stopPropagation();
                        
                        const currentModalId = this.closest('.modal').id;
                        console.log(`Clicked sub-tile targeting: ${targetModal}, from parent: ${currentModalId}`);
                        
                        // Add current modal to stack before opening the sub-modal
                        console.log(`Adding ${currentModalId} to modal stack`);
                        if (!modalStack.includes(currentModalId)) {
                            modalStack.push(currentModalId);
                        }
                        
                        // Use timeout to ensure proper transition
                        const parentModal = document.getElementById(currentModalId);
                        parentModal.style.display = "none";
                        parentModal.style.opacity = "0";
                        parentModal.classList.remove("show");
                        
                        // Open target modal
                        setTimeout(() => {
                            openModal(targetModal);
                        }, 50);
                    });
                } else {
                    console.warn('Sub-tile missing data-target-modal attribute:', tile);
                }
            });
        }

        // Setup modal controls (close buttons, back buttons, etc.)
        function setupModalControls() {
            console.log('Setting up modal controls');
            
            // Close buttons
            document.querySelectorAll('.modal .close').forEach(closeBtn => {
                console.log('Setting up close button');
                // Replace with cloned element to ensure clean event listeners
                const newCloseBtn = closeBtn.cloneNode(true);
                closeBtn.parentNode.replaceChild(newCloseBtn, closeBtn);
                
                newCloseBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    const modalId = this.closest('.modal').id;
                    console.log(`Close button clicked in modal: ${modalId}`);
                    closeModal(modalId);
                });
            });

            // Back buttons
            document.querySelectorAll('.back-button').forEach(button => {
                console.log('Setting up back button');
                // Replace with cloned element to ensure clean event listeners
                const newButton = button.cloneNode(true);
                button.parentNode.replaceChild(newButton, button);
                
                newButton.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    const currentModalId = this.closest('.modal').id;
                    console.log(`Back button clicked in modal: ${currentModalId}`);
                    
                    // Check if there's a specific parent modal defined
                    const parentModal = this.getAttribute('data-parent-modal');
                    if (parentModal) {
                        console.log(`Using defined parent modal: ${parentModal}`);
                        closeModal(currentModalId);
                        setTimeout(() => {
                            openModal(parentModal);
                        }, 50);
                    } else if (modalStack.length > 0) {
                        const stackParentModal = modalStack[modalStack.length - 1];
                        console.log(`Going back to parent modal from stack: ${stackParentModal}`);
                        closeModal(currentModalId);
                        setTimeout(() => {
                            openModal(stackParentModal);
                        }, 50);
                    } else {
                        closeModal(currentModalId);
                    }
                });
            });

            // Breadcrumb navigation
            document.querySelectorAll('.modal-breadcrumb span').forEach(span => {
                if (!span.classList.contains('separator')) {
                    console.log('Setting up breadcrumb item');
                    // Replace with cloned element to ensure clean event listeners
                    const newSpan = span.cloneNode(true);
                    span.parentNode.replaceChild(newSpan, span);
                    
                    newSpan.addEventListener('click', function(e) {
                        e.preventDefault();
                        e.stopPropagation();
                        const currentModalId = this.closest('.modal').id;
                        
                        // Check if there's a specific target modal defined
                        const targetModal = this.getAttribute('data-target-modal');
                        if (targetModal) {
                            console.log(`Using defined target modal: ${targetModal}`);
                            closeModal(currentModalId);
                            setTimeout(() => {
                                openModal(targetModal);
                            }, 50);
                            return;
                        }
                        
                        // Otherwise use text content to determine target
                        const targetText = this.textContent.trim();
                        console.log(`Breadcrumb clicked: ${targetText} from modal: ${currentModalId}`);
                        
                        // Map text content to modal IDs
                        const inferredTargetModal = 
                            targetText === 'IVC' ? 'ivcModal' :
                            targetText === 'Hepatic Vein' ? 'hepaticModal' :
                            targetText === 'Portal Vein' ? 'portalModal' :
                            targetText === 'Renal Vein' ? 'renalModal' : null;
                        
                        if (inferredTargetModal) {
                            console.log(`Navigating to: ${inferredTargetModal}`);
                            closeModal(currentModalId);
                            setTimeout(() => {
                                openModal(inferredTargetModal);
                            }, 50);
                        }
                    });
                }
            });
            
            // Slideshow controls
            document.querySelectorAll('.prev, .next').forEach(control => {
                console.log('Setting up slideshow control');
                // Replace with cloned element to ensure clean event listeners
                const newControl = control.cloneNode(true);
                control.parentNode.replaceChild(newControl, control);
                
                newControl.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    const slideshowClass = this.getAttribute('data-slideshow');
                    const direction = parseInt(this.getAttribute('data-direction') || '1');
                    
                    if (slideshowClass) {
                        console.log(`Slideshow navigation: ${slideshowClass}, direction: ${direction}`);
                        plusSlides(direction, slideshowClass);
                    }
                });
            });
        }

        // Opens modal by ID
        function openModal(modalId) {
            console.log(`Opening modal: ${modalId}`);
            const modal = document.getElementById(modalId);
            if (!modal) {
                console.error(`Modal not found: ${modalId}`);
                return;
            }
            
            // Update current modal
            currentModal = modalId;
            
            // Show the modal (force display block and ensure it's visible)
            modal.style.display = "block";
            modal.style.opacity = "1";
            modal.classList.add("show");
            document.body.style.overflow = 'hidden';
            
            // Make modal content visible
            const modalContent = modal.querySelector('.modal-content');
            if (modalContent) {
                modalContent.style.opacity = "1";
                modalContent.style.transform = "translateY(0)";
            }
            
            // Log what's visible for debugging
            console.log(`Modal ${modalId} opened with display: ${modal.style.display}, opacity: ${modal.style.opacity}`);
            
            // Initialize slideshow if present
            const container = modal.querySelector('.slideshow-content');
            if (container) {
                const imgs = container.getElementsByTagName("img");
                const descriptions = container.getElementsByClassName("image-description");
                if (imgs.length) {
                    // Hide all images first
                    Array.from(imgs).forEach((img, index) => {
                        img.style.display = "none";
                        if (descriptions[index]) {
                            descriptions[index].style.display = "none";
                        }
                    });
                    
                    // Show the first image
                    if (imgs[0]) {
                    imgs[0].style.display = "block";
                        if (descriptions[0]) {
                            descriptions[0].style.display = "block";
                        }
                    }
                    
                    slideIndex[container.classList[1]] = 0;
                }
            }
        }

        // Closes modal
        function closeModal(modalId) {
            console.log(`Closing modal: ${modalId}`);
            const modal = document.getElementById(modalId);
            if (!modal) {
                console.error(`Modal not found: ${modalId}`);
                return;
            }
            
            // Hide the modal
                modal.style.display = "none";
            modal.style.opacity = "0";
            modal.classList.remove("show");
            
            // If there's a modal in the stack, show it
            if (modalStack.length > 0) {
                currentModal = modalStack.pop();
                console.log(`Returning to modal from stack: ${currentModal}`);
                const previousModal = document.getElementById(currentModal);
                if (previousModal) {
                    previousModal.style.display = "block";
                    previousModal.style.opacity = "1";
                    previousModal.classList.add("show");
                    
                    // Make modal content visible
                    const modalContent = previousModal.querySelector('.modal-content');
                    if (modalContent) {
                        modalContent.style.opacity = "1";
                        modalContent.style.transform = "translateY(0)";
                    }
                }
            } else {
                document.body.style.overflow = '';
                currentModal = null;
            }
        }

        // Next/prev for slides
        function plusSlides(n, className) {
            const container = document.getElementsByClassName(className)[0];
            if (!container) return;

            const imgs = container.getElementsByTagName("img");
            const descriptions = container.getElementsByClassName("image-description");
            if (!imgs.length) return;

            if (!slideIndex[className] && slideIndex[className] !== 0) {
                slideIndex[className] = 0;
            }

            // Hide current image and description
            imgs[slideIndex[className]].style.display = "none";
            if (descriptions[slideIndex[className]]) {
                descriptions[slideIndex[className]].style.display = "none";
            }

            // Calculate new index
            slideIndex[className] += n;
            if (slideIndex[className] >= imgs.length) {
                slideIndex[className] = 0;
            }
            if (slideIndex[className] < 0) {
                slideIndex[className] = imgs.length - 1;
            }

            // Show new image and description
            imgs[slideIndex[className]].style.display = "block";
            if (descriptions[slideIndex[className]]) {
                descriptions[slideIndex[className]].style.display = "block";
            }
        }

        // Setup tag filtering system
        function setupTagFiltering() {
            const activeFilters = {
                quality: [],
                vein: [],
                waveform: []
            };

            // Initialize tag click handlers
            document.querySelectorAll('.tag-container[data-filter-group]').forEach(container => {
                const group = container.dataset.filterGroup;
                if (!group) return;
                
                container.querySelectorAll('.tag').forEach(tag => {
                    tag.addEventListener('click', () => {
                        const value = tag.dataset.tag;
                        if (!value) return;
                        
                        if (tag.classList.contains('active')) {
                            // Remove filter
                            tag.classList.remove('active');
                            activeFilters[group] = activeFilters[group].filter(t => t !== value);
                        } else {
                            // Add filter
                            tag.classList.add('active');
                            activeFilters[group].push(value);
                        }
                        
                        updateActiveFiltersUI();
                        updateGalleryItems();
                    });
                });
            });

            // Handle removing active filters
            document.querySelector('.active-filters')?.addEventListener('click', (e) => {
                if (e.target.classList.contains('remove')) {
                    const group = e.target.dataset.group;
                    const tag = e.target.dataset.tag;
                    
                    // Remove from active filters
                    activeFilters[group] = activeFilters[group].filter(t => t !== tag);
                    
                    // Update tag UI
                    document.querySelector(`.tag[data-tag="${tag}"]`)?.classList.remove('active');
                    
                    updateActiveFiltersUI();
                    updateGalleryItems();
                }
            });

            // Clear all filters
            document.querySelector('.clear-filters')?.addEventListener('click', () => {
                Object.keys(activeFilters).forEach(group => {
                    activeFilters[group] = [];
                });
                
                document.querySelectorAll('.tag.active').forEach(tag => {
                    tag.classList.remove('active');
                });
                
                updateActiveFiltersUI();
                updateGalleryItems();
            });

            function updateActiveFiltersUI() {
                const container = document.querySelector('.active-filters');
                if (!container) return;
                
                // Clear existing active filters except the "Clear all" button
                while (container.firstChild && !container.firstChild.classList.contains('clear-filters')) {
                    container.removeChild(container.firstChild);
                }

                // Add new active filter tags
                Object.entries(activeFilters).forEach(([group, tags]) => {
                    tags.forEach(tag => {
                        const filterTag = document.createElement('span');
                        filterTag.className = 'active-filter';
                        filterTag.innerHTML = `${tag} <span class="remove" data-group="${group}" data-tag="${tag}">Ã—</span>`;
                        container.insertBefore(filterTag, container.querySelector('.clear-filters'));
                    });
                });

                // Show/hide clear all button
                const clearAll = container.querySelector('.clear-filters');
                if (clearAll) {
                    const hasActiveFilters = Object.values(activeFilters).some(arr => arr.length > 0);
                    clearAll.style.display = hasActiveFilters ? 'block' : 'none';
                }
            }

            function updateGalleryItems() {
                const items = document.querySelectorAll('.gallery-item');
                
                items.forEach(item => {
                    let visible = true;
                    
                    // Check each filter group
                    Object.entries(activeFilters).forEach(([group, tags]) => {
                        if (tags.length > 0) {
                            const itemTags = item.dataset[group]?.split(',') || [];
                            const hasMatch = tags.some(tag => itemTags.includes(tag));
                            if (!hasMatch) visible = false;
                        }
                    });
                    
                    item.classList.toggle('hidden', !visible);
                });
            }
        }

        // Setup modal filters for subfolders
        function setupModalFilters() {
            document.querySelectorAll('.modal-filters .tag').forEach(tag => {
                tag.addEventListener('click', () => {
                    const group = tag.parentElement.dataset.filterGroup;
                    if (!group) return;
                    
                    const value = tag.dataset.tag;
                    if (!value) return;
                    
                    const isActive = tag.classList.contains('active');
                    
                    // Toggle active state
                    if (isActive) {
                        tag.classList.remove('active');
                    } else {
                        // If it's a single-select filter, deactivate others in the group
                        tag.parentElement.querySelectorAll('.tag').forEach(t => t.classList.remove('active'));
                        tag.classList.add('active');
                    }
                    
                    // Filter sub-tiles
                    filterSubTiles(group, isActive ? null : value);
                });
            });

            function filterSubTiles(group, value) {
                const subTiles = document.querySelectorAll('.sub-tiles .sub-tile');
                subTiles.forEach(tile => {
                    if (!value) {
                        tile.style.display = 'block';
                        return;
                    }
                    
                    const tileValue = tile.dataset[group];
                    tile.style.display = tileValue === value ? 'block' : 'none';
                });
            }
        }

        // Setup gallery image upload functionality
        function setupGalleryUpload() {
        const galleryUploadArea = document.getElementById('galleryUploadArea');
        const galleryImageInput = document.getElementById('galleryImageInput');
            
            if (!galleryUploadArea || !galleryImageInput) return;

        galleryUploadArea.addEventListener('click', () => galleryImageInput.click());
        galleryImageInput.addEventListener('change', handleGalleryImageUpload);

        galleryUploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            galleryUploadArea.style.borderColor = '#28a745';
            galleryUploadArea.style.backgroundColor = 'rgba(40, 167, 69, 0.05)';
        });

        galleryUploadArea.addEventListener('dragleave', () => {
            galleryUploadArea.style.borderColor = '#ccc';
            galleryUploadArea.style.backgroundColor = 'transparent';
        });

        galleryUploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            galleryUploadArea.style.borderColor = '#ccc';
            galleryUploadArea.style.backgroundColor = 'transparent';
            if (e.dataTransfer.files.length) {
                galleryImageInput.files = e.dataTransfer.files;
                handleGalleryImageUpload({ target: { files: e.dataTransfer.files } });
            }
        });

        // Handle gallery submission
            document.getElementById('gallerySubmissionForm')?.addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const formData = new FormData();
            const imageFile = document.getElementById('galleryImageInput').files[0];
            
            if (!imageFile) {
                document.querySelector('#gallerySubmissionForm .error-message').textContent = 'Please upload an image.';
                document.querySelector('#gallerySubmissionForm .error-message').style.display = 'block';
                document.querySelector('#gallerySubmissionForm .success-message').style.display = 'none';
                return;
            }

            formData.append('image', imageFile);
            formData.append('email', document.getElementById('gallery_email').value);
            formData.append('title', document.getElementById('gallery_title').value);
            formData.append('institution', document.getElementById('gallery_institution').value);
            formData.append('description', document.getElementById('gallery_description').value);

            try {
                const response = await fetch('/api/gallery-submission', {
                    method: 'POST',
                    body: formData
                });

                if (response.ok) {
                    document.querySelector('#gallerySubmissionForm .success-message').style.display = 'block';
                    document.querySelector('#gallerySubmissionForm .error-message').style.display = 'none';
                    document.getElementById('gallerySubmissionForm').reset();
                    resetGalleryImageUpload();
                } else {
                    const errorData = await response.json();
                    throw new Error(errorData.message || 'Failed to submit image');
                }
            } catch (error) {
                document.querySelector('#gallerySubmissionForm .error-message').textContent = 
                    error.message || 'Sorry, there was an error submitting your image. Please try again.';
                document.querySelector('#gallerySubmissionForm .error-message').style.display = 'block';
                document.querySelector('#gallerySubmissionForm .success-message').style.display = 'none';
            }
        });
        }

        function handleGalleryImageUpload(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const preview = document.getElementById('galleryImagePreview');
                    const container = document.querySelector('#gallerySubmissionForm .image-preview-container');
                    preview.src = e.target.result;
                    preview.style.display = 'block';
                    container.style.display = 'block';
                    document.querySelector('#galleryUploadArea').style.borderColor = '#28a745';
                }
                reader.readAsDataURL(file);
            }
        }

        function resetGalleryImageUpload() {
            document.getElementById('galleryImageInput').value = '';
            document.getElementById('galleryImagePreview').style.display = 'none';
            document.querySelector('#gallerySubmissionForm .image-preview-container').style.display = 'none';
            document.querySelector('#galleryUploadArea').style.borderColor = '#ccc';
        }
    </script>
    <!-- Menu Toggle Script -->
    <script>
        // Function to initialize menu toggle
        function initializeMenuToggle() {
            console.log("Initializing menu toggle");
            
            try {
                // Get menu elements
                const menuToggle = document.querySelector("a[href=\"#menu\"]");
                const menu = document.getElementById("menu");
                
                if (!menuToggle) {
                    console.error("Menu toggle element not found!");
                    return;
                }
                
                if (!menu) {
                    console.error("Menu element not found!");
                    return;
                }
                
                // First ensure menu is properly hidden to start
                document.body.classList.remove("is-menu-visible");
                menu.style.right = "-100%";
                menu.style.display = "none";
                menu.classList.remove("visible", "active");
                
                // Remove any existing click handlers by cloning and replacing
                const newMenuToggle = menuToggle.cloneNode(true);
                menuToggle.parentNode.replaceChild(newMenuToggle, menuToggle);
                
                // Add our click handler with support for both CSS class and display property
                newMenuToggle.addEventListener("click", function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    console.log("Menu toggle clicked");
                    
                    // Use both approaches: class toggle (for theme) and display property (for our custom code)
                    document.body.classList.add("is-menu-visible");
                    menu.style.display = "block";
                    menu.style.right = "0";
                    menu.classList.add("visible", "active");
                    
                    // Force a repaint to ensure styles are applied
                    void menu.offsetWidth;
                });
                
                // Create close button handler (important for mobile)
                const closeButton = menu.querySelector("a.close");
                if (closeButton) {
                    const newCloseButton = closeButton.cloneNode(true);
                    closeButton.parentNode.replaceChild(newCloseButton, closeButton);
                    
                    newCloseButton.addEventListener("click", function(e) {
                        e.preventDefault();
                        e.stopPropagation();
                        console.log("Close button clicked");
                        
                        // Hide menu using both approaches
                        document.body.classList.remove("is-menu-visible");
                        menu.style.display = "none";
                        menu.style.right = "-100%";
                        menu.classList.remove("visible", "active");
                    });
                }
                
                // Handle clicks outside the menu (use capture phase to run before other handlers)
                const bodyClickHandler = function(e) {
                    // If clicking outside menu and not on menu toggle
                    if (!e.target.closest("#menu") && !e.target.closest("a[href=\"#menu\"]")) {
                        console.log("Clicked outside menu");
                        
                        // Hide menu using both approaches
                        document.body.classList.remove("is-menu-visible");
                        menu.style.display = "none";
                        menu.style.right = "-100%";
                        menu.classList.remove("visible", "active");
                    }
                };
                
                // Remove any existing body click handler and add our new one
                document.body.removeEventListener("click", bodyClickHandler, true);
                document.body.addEventListener("click", bodyClickHandler, true);
                
                // Handle escape key
                const keyHandler = function(e) {
                    if (e.key === "Escape" || e.keyCode === 27) {
                        document.body.classList.remove("is-menu-visible");
                        menu.style.display = "none";
                        menu.style.right = "-100%";
                        menu.classList.remove("visible", "active");
                    }
                };
                
                // Remove any existing key handler and add our new one
                document.removeEventListener("keydown", keyHandler);
                document.addEventListener("keydown", keyHandler);
                
                console.log("Menu toggle initialization complete");
            } catch (error) {
                console.error("Error initializing menu toggle:", error);
            }
        }
        
        // Initialize the menu toggle after DOM is loaded
        document.addEventListener("DOMContentLoaded", function() {
            console.log("DOM loaded, initializing menu toggle");
            // Initial setup with delay to ensure DOM is fully processed
            setTimeout(initializeMenuToggle, 100);
        });
        
        // Fallback initialization in case DOMContentLoaded already fired
        if (document.readyState === "complete" || document.readyState === "interactive") {
            console.log("Document already loaded, running fallback initialization");
            setTimeout(initializeMenuToggle, 200);
        }
    </script>
<script src="html5up-phantom/assets/js/add-tpa-link.js"></script>
</body>
</html>

