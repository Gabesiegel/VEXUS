<!DOCTYPE HTML>
<html lang="en">
<head>
    <title>Waveforms - VExUS ATLAS</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <meta name="author" content="Gabesiegel" />
    <meta name="last-modified" content="2024-03-07" />
    
    <!-- Initial visibility control -->
    <style>
    body {
        opacity: 0;
        transition: opacity 0.3s ease;
    }
    </style>
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        document.body.style.opacity = '1';
        if (typeof initializeMenuToggle === 'function') {
            initializeMenuToggle();
        }
    });
    </script>
    
    <!-- CSS -->
    <link rel="stylesheet" href="html5up-phantom/assets/css/main.css" />
    <link rel="stylesheet" href="html5up-phantom/assets/css/fontawesome-all.min.css" />
    <link rel="stylesheet" href="html5up-phantom/assets/css/mobile.css" />
    <!-- Add Fancybox CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0/dist/fancybox/fancybox.css" />
    <!-- Custom CSS - Load these last to override any previous styles -->
    <link rel="stylesheet" href="html5up-phantom/assets/css/header.css" />
    <link rel="stylesheet" href="html5up-phantom/assets/css/logo.css" />
    <link rel="stylesheet" href="html5up-phantom/assets/css/sidebar.css" />
    <noscript><link rel="stylesheet" href="html5up-phantom/assets/css/noscript.css" /></noscript>
    
    <!-- Critical menu styles -->
    <style>
        /* Critical styles for menu visibility */
        body.is-menu-visible #menu {
            display: block !important;
            visibility: visible !important;
            right: 0 !important;
            z-index: 10000 !important;
        }
        
        #menu {
            transition: all 0.5s ease;
            position: fixed !important;
            top: 0 !important;
            height: 100% !important;
            width: 300px !important;
            max-width: 80% !important;
            right: -300px !important;
            z-index: 10000 !important;
            overflow-y: auto !important;
            background: rgba(255, 255, 255, 0.98);
            box-shadow: -5px 0 25px rgba(0, 0, 0, 0.08);
        }
        
        #menu.visible {
            display: block !important;
            visibility: visible !important;
            right: 0 !important;
            transform: translateX(0);
        }
        
        /* Increase z-index for menu toggle button */
        a[href="#menu"] {
            z-index: 9000 !important;
            position: relative !important;
        }
        
        /* Ensure menu appears above other elements */
        nav#menu {
            z-index: 10000 !important;
        }

        /* Header Styles */
        #header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            box-shadow: 0 1px 4px rgba(0,0,0,0.05);
            height: 3.5em; /* Reduced height */
        }

        #header .inner {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0.1em 1.5em; /* Reduced top/bottom padding */
            height: 100%;
        }

        /* Add margin to main content to prevent it from being hidden behind fixed header */
        #main {
            padding-top: 5.5em; /* Increased padding from 4.5em */
            margin-top: 0;
        }

        #main .inner {
            padding-top: 3em; /* Increased padding from 2em */
        }

        /* Remove margin from logo container */
        .logo-container {
            margin-top: 2em; /* Increased margin from 1em */
        }

        #header .logo {
            text-decoration: none;
            border: 0;
            display: flex;
            align-items: center;
        }

        #header .logo .symbol {
            margin-right: 0.5em; /* Reduced margin */
        }

        #header .logo .symbol img {
            width: 2.8em; /* Reduced size */
            height: 2.8em;
            object-fit: contain;
        }

        #header .logo .title {
            color: #585858;
            font-size: 1.1em; /* Reduced size */
            font-weight: 700;
            text-shadow: 0 1px 2px rgba(255,255,255,0.8); /* Help text readability */
        }

        /* Responsive adjustments */
        @media screen and (max-width: 736px) {
            #header {
                height: 3em;
            }

            #header .inner {
                padding: 0.2em 1em;
            }
            
            #main {
                padding-top: 4.5em; /* Adjusted for mobile */
            }
            
            #main .inner {
                padding-top: 2em;
            }
            
            #header .logo .symbol img {
                width: 2.5em;
                height: 2.5em;
            }
            
            #header .logo .title {
                font-size: 1em;
            }
        }

        @media screen and (max-width: 480px) {
            #header {
                height: 2.8em;
                background: rgba(255, 255, 255, 0.98); /* Slightly more opaque on mobile */
            }

            #header .inner {
                padding: 0.1em 0.8em; /* Reduced padding */
            }
            
            #main {
                padding-top: 4em; /* Adjusted for smaller screens */
            }
            
            #main .inner {
                padding-top: 1.5em;
            }
            
            #header .logo .symbol img {
                width: 2.2em;
                height: 2.2em;
            }
            
            #header .logo .title {
                font-size: 0.9em;
            }
        }

        /* Main Content Styles */
        .waveform-container {
            max-width: 1200px;
            margin: 1rem auto 2rem;
            padding: 2rem;
            background: #ffffff;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.05);
        }

        .education-header {
            text-align: center;
            margin: 1rem 0 3rem;
        }

        .education-header h1 {
            color: #333;
            font-size: 2.25rem;
            margin-bottom: 1rem;
            line-height: 1.3;
        }

        #main > .inner {
            padding: 40px;
            background: #ffffff;
            border-radius: 10px;
            margin: 20px auto;
            max-width: 1400px;
        }

        /* Menu Navigation Styles */
        nav#menu {
            background: #ffffff;
            padding: 20px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            -webkit-overflow-scrolling: touch;
        }

        nav#menu .logo-container {
            padding: 10px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        nav#menu h2 {
            color: #888888;
            margin-bottom: 1em;
            font-size: inherit;
        }

        nav#menu ul li {
            border-top: solid 1px rgba(0, 0, 0, 0.1);
            padding: 0.5em 0;
        }

        nav#menu ul li a {
            color: #888888 !important;
            text-decoration: none;
            border-bottom: none;
            font-size: 0.9em;
            transition: color 0.2s ease;
            display: block;
            padding: 8px 0;
        }

        nav#menu ul li a:hover {
            color: #777777 !important;
        }

        /* Overlay for mobile menu */
        .menu-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.2);
            z-index: 999;
            opacity: 0;
            transition: opacity 0.3s ease;
            will-change: opacity;
        }

        .menu-overlay.active {
            display: block;
            opacity: 1;
        }

        /* Custom Scrollbar */
        nav#menu::-webkit-scrollbar {
            width: 6px;
        }

        .waveform-section {
            margin-bottom: 40px;
            padding: 30px;
            background: #fcfcfc;
            border-radius: 8px;
            transition: transform 0.3s ease;
        }

        .waveform-section:hover {
            transform: translateY(-5px);
        }

        .waveform-section h2 {
            color: #2c3e50;
            border-bottom: 2px solid #e9ecef;
            padding-bottom: 10px;
            margin-bottom: 20px;
            text-align: center;

        }

        .waveform-image {
            max-width: 100%;
            height: auto;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        .waveform-section h3 {
            color: #34495e;
            margin-top: 20px;
            margin-bottom: 15px;
            font-weight: 600;
            text-align: center;
        }
        
        .waveform-section ul, .waveform-section ol {
            margin-left: 25px;
            margin-bottom: 20px;
        }
        
        .waveform-section li {
            margin-bottom: 10px;
            line-height: 1.6;
        }
        
        .reference-list {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #e9ecef;
            font-size: 0.9em;
        }
        
        .reference-list li {
            margin-bottom: 8px;
        }
        
        .reference-list a {
            color: #3498db;
            text-decoration: none;
            border-bottom: 1px dotted #3498db;
        }
        
        .reference-list a:hover {
            border-bottom: 1px solid #3498db;
        }

        /* Tile styling for images */
        .image-tile {
            background: #ffffff;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            padding: 20px;
            margin: 25px 0;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            overflow: hidden;
        }
        
        .image-tile:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.15);
        }
        
        .image-tile img {
            width: 100%;
            border-radius: 6px;
            margin-bottom: 15px;
        }
        
        .image-tile .caption {
            font-size: 1.05em;
            color: #34495e;
            text-align: left;
            padding: 0 10px;
            line-height: 1.5;
        }
        
        .image-tile .title {
            font-size: 1.25em;
            font-weight: 600;
            margin-bottom: 10px;
            color: #2c3e50;
            text-align: left;
        }

        /* Updated references styling */
        .references-section {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 10px;
            margin-top: 40px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        .references-section h2 {
            border-bottom: 2px solid #e9ecef;
            padding-bottom: 15px;
            margin-bottom: 25px;
            color: #2c3e50;
            font-weight: 600;
        }
        
        .references-list {
            counter-reset: ref-counter;
            list-style-type: none;
            padding-left: 0;
            margin-left: 0;
        }
        
        .references-list li {
            position: relative;
            padding-left: 35px;
            margin-bottom: 20px;
            line-height: 1.6;
        }
        
        .references-list li::before {
            counter-increment: ref-counter;
            content: counter(ref-counter);
            position: absolute;
            left: 0;
            top: 0;
            font-weight: 600;
            color: #3498db;
            background: #e1f0fa;
            width: 25px;
            height: 25px;
            border-radius: 50%;
            text-align: center;
            line-height: 25px;
            font-size: 0.85em;
        }
        
        .references-list a {
            color: #3498db;
            text-decoration: none;
            transition: color 0.2s;
            border-bottom: 1px dotted #3498db;
            padding-bottom: 1px;
        }
        
        .references-list a:hover {
            color: #2980b9;
            border-bottom: 1px solid #2980b9;
        }
        
        /* Updated citation styling to match education.html without blue coloring and without dotted line */
        .citation {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            min-width: 20px;
            height: 20px;
            background-color: #f0f0f0;
            color: #666;
            border-radius: 10px;
            font-size: 0.8em;
            padding: 0 6px;
            margin: 0 2px;
            font-weight: 500;
            transition: all 0.2s ease;
            vertical-align: super;
            text-decoration: none;
            border: none;
        }

        .citation:hover {
            background-color: #6c757d;
            color: white;
            transform: translateY(-1px);
        }

        /* Remove blue color and dotted line from citation links */
        .citation a {
            color: inherit;
            text-decoration: none;
            border: none;
        }

        .citation a:hover {
            color: inherit;
            text-decoration: none;
            border: none;
        }

        /* Remove old superscript citation styling */
        sup.citation {
            font-size: 0.75em;
            line-height: 0;
            position: relative;
            vertical-align: baseline;
            top: -0.5em;
            margin: 0 2px;
            border: none;
        }
        
        sup.citation a {
            color: inherit;
            text-decoration: none;
            padding: 0 2px;
            border-radius: 3px;
            transition: background-color 0.2s;
            border: none;
        }
        
        sup.citation a:hover {
            background-color: #e1f0fa;
            color: inherit;
            border: none;
        }

        /* Updated references styling to match education.html */
        .reference-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .reference-tile {
            background-color: #fcfcfc;
            border-radius: 8px;
            padding: 20px;
            transition: transform 0.3s ease;
        }

        .reference-tile:hover {
            transform: translateY(-1px);
        }

        .reference-number {
            display: inline-block;
            background-color: #6c757d;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            text-align: center;
            line-height: 30px;
            margin-right: 10px;
            font-weight: bold;
        }

        .reference-title {
            font-weight: 600;
            margin-bottom: 10px;
            color: #2c3e50;
        }

        .reference-authors {
            font-style: italic;
            color: #555;
            margin-bottom: 8px;
        }

        .reference-journal {
            color: #666;
            margin-bottom: 8px;
        }

        .reference-link {
            display: inline-block;
            margin-top: 10px;
            color: #6c757d;
            text-decoration: none;
            font-weight: 500;
        }

        .reference-link:hover {
            color: #495057;
            text-decoration: underline;
        }

        /* Remove CSS-based scroll controls */
        .fancybox__container {
            --fancybox-scrollbar-width: 8px;
            --fancybox-scrollbar-background: rgba(24, 24, 24, 0.1);
            --fancybox-scrollbar-thumb: rgba(24, 24, 24, 0.3);
        }

        .fancybox__content {
            padding: 0;
            max-height: none;
            overflow-y: visible;
        }

        .fancybox__content::-webkit-scrollbar {
            display: none;
        }

        /* Prevent body scroll when lightbox is open */
        body.fancybox-active {
            overflow: visible;
        }

        /* Update lightbox content styling */
        .lightbox-content {
            padding: 30px;
            background: #fff;
            border-radius: 8px;
            margin: 0;
            width: 100%;
            box-sizing: border-box;
        }

        /* Ensure images don't overflow */
        .lightbox-content img {
            max-width: 100%;
            height: auto;
        }

        /* Mobile optimizations */
        @media (max-width: 768px) {
            .fancybox__button {
                width: 42px !important;
                height: 42px !important;
            }
            
            .fancybox__toolbar {
                padding: 8px !important;
            }
            
            .fancybox__slide {
                padding: 12px !important;
            }
        }

        /* Image hover effects */
        .image-container img {
            transition: transform 0.3s ease;
            cursor: pointer;
        }

        .image-container img:hover {
            transform: scale(1.02);
        }

        /* Improved Fancybox 5.0 styling */
        .fancybox__container {
            --fancybox-bg: rgba(24, 24, 27, 0.95);
            /* Ensure fancybox appears above the header */
            --fancybox-ui-primary-color: #fff;
            --fancybox-ui-secondary-color: rgba(255, 255, 255, 0.8);
            z-index: 10001 !important; /* Higher than header's z-index */
        }

        /* Force container above everything */
        .fancybox__backdrop {
            background: rgba(0, 0, 0, 0.85);
            z-index: 10000 !important;
        }

        /* Ensure toolbar and buttons are visible */
        .fancybox__toolbar {
            z-index: 10002 !important;
            visibility: visible !important;
            opacity: 1 !important;
        }

        /* Ensure close button is visible */
        .fancybox__button--close {
            background-color: rgba(255, 255, 255, 0.9) !important;
            color: #000 !important;
            opacity: 1 !important;
            visibility: visible !important;
            z-index: 10003 !important;
            position: relative !important;
        }

        .fancybox__button--close:hover {
            background-color: #fff !important;
        }

        /* Ensure buttons are properly sized */
        .fancybox__button {
            width: 46px !important;
            height: 46px !important;
        }
        
        /* Ensure content is visible */
        .fancybox__content {
            z-index: 10002 !important;
        }
        
        /* Ensure captions are visible */
        .fancybox__caption {
            visibility: visible !important;
            opacity: 1 !important;
            color: white !important;
            padding: 10px 15px !important;
            background: rgba(0, 0, 0, 0.7) !important;
        }
        
        /* Fix slide visibility */
        .fancybox__slide {
            opacity: 1 !important;
            visibility: visible !important;
        }
        
        /* Ensure images are visible */
        .fancybox__image {
            opacity: 1 !important;
            visibility: visible !important;
            max-height: 90vh !important;
            position: relative !important;
            z-index: 10005 !important; /* Even higher z-index */
            background: transparent !important;
            display: block !important;
        }
        
        /* Fix content container */
        .fancybox__container .fancybox__content {
            background: transparent !important;
            border: none !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            max-width: none !important;
            max-height: none !important;
            padding: 0 !important;
            margin: 0 !important;
            position: relative !important;
        }
        
        /* Fix slide container */
        .fancybox__slide.is-selected {
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            opacity: 1 !important;
            visibility: visible !important;
        }
        
        /* Ensure carousel is visible */
        .fancybox__carousel {
            z-index: 10004 !important;
            opacity: 1 !important;
            visibility: visible !important;
            overflow: visible !important;
        }
        
        /* Lower the header z-index to prevent conflicts */
        #header {
            z-index: 999 !important;
        }
        
        /* Ensure the menu still works */
        #menu, a[href="#menu"] {
            z-index: 1000 !important;
        }

        /* Content Structure */
        .container {
            width: 100%;
            max-width: 1400px;
            background: white;
            padding: 2rem 3rem;
            margin: 1.5rem auto 3rem;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        @media screen and (max-width: 980px) {
            .container {
                padding: 1.5rem;
                max-width: 95%;
            }
            
            .waveform-container {
                padding: 1.5rem;
            }
            
            .education-header {
                margin: 0.5rem 0 2rem;
            }
            
            .education-header h1 {
                font-size: 2rem;
            }
        }

        @media screen and (max-width: 480px) {
            .container {
                padding: 1.25rem;
                margin: 1rem auto 2rem;
            }
            
            .waveform-container {
                padding: 1.25rem;
            }
            
            .education-header h1 {
                font-size: 1.75rem;
            }
        }

        /* Logo Styles */
        .logo-container {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 2rem;
            margin: 2rem auto;
            padding: 0 1rem;
            max-width: 1400px;
            width: 100%;
        }

        .logo {
            max-width: 300px;
            height: auto;
            object-fit: contain;
            transition: transform 0.3s ease;
        }

        .logo:hover {
            transform: scale(1.02);
        }

        /* Responsive logo adjustments */
        @media screen and (max-width: 980px) {
            .logo-container {
                flex-direction: column;
                gap: 1.5rem;
            }
            
            .logo {
                max-width: 250px;
            }
        }

        @media screen and (max-width: 480px) {
            .logo-container {
                margin: 1.5rem auto;
            }
            
            .logo {
                max-width: 200px;
            }
        }

        .sidebar-logo {
            width: 100px;
            height: auto;
            margin: 0 auto;
            display: block;
            padding: 5px;
            transition: transform 0.3s ease;
        }

        .sidebar-logo:hover {
            transform: scale(1.1);
        }

        /* Additional critical Fancybox fixes */
        /* Force visible images */
        img.fancybox-image {
            display: block !important;
            opacity: 1 !important;
            visibility: visible !important;
            max-width: 100% !important;
            max-height: 90vh !important;
            margin: 0 auto !important;
        }
        
        /* Fix iframe handling */
        .fancybox__iframe {
            background: transparent !important;
            border: 0 !important;
            height: 100% !important;
            width: 100% !important;
            display: block !important;
        }
        
        /* Ensure proper stacking context */
        .fancybox__container * {
            box-sizing: border-box !important;
        }
        
        /* Reset any transforms that might interfere */
        .fancybox__content,
        .fancybox__slide,
        .fancybox__carousel {
            transform: none !important;
        }
        
        /* Fix slide content */
        .is-draggable {
            cursor: grab !important;
        }
        
        /* Ensure visible */
        [data-fancybox-loaded="true"] {
            visibility: visible !important;
            opacity: 1 !important;
        }

        /* Mobile optimization enhancements */
        @media screen and (max-width: 736px) {
            /* Increase touch target sizes for mobile */
            nav#menu ul li a {
                padding: 12px 0;
                font-size: 1em;
            }
            
            a[href="#menu"] {
                width: 44px;
                height: 44px;
                display: flex;
                align-items: center;
                justify-content: center;
            }
            
            /* Adjust spacing in waveform sections */
            .waveform-section {
                padding: 20px 15px;
                margin-bottom: 25px;
            }
            
            .waveform-section h2 {
                font-size: 1.4em;
                padding-bottom: 8px;
                margin-bottom: 15px;
            }
            
            .waveform-section h3 {
                font-size: 1.2em;
                margin-top: 15px;
                margin-bottom: 10px;
            }
            
            /* Make lists more readable on mobile */
            .waveform-section ul, .waveform-section ol {
                margin-left: 15px;
                margin-bottom: 15px;
            }
            
            .waveform-section li {
                margin-bottom: 8px;
                line-height: 1.5;
                font-size: 0.95em;
            }
            
            /* Improve image tiles on mobile */
            .image-tile {
                padding: 15px;
                margin: 20px 0;
            }
            
            .image-tile .title {
                font-size: 1.15em;
                margin-bottom: 8px;
            }
            
            .image-tile .caption {
                font-size: 0.95em;
                padding: 0 5px;
            }
            
            /* Adjust citation display on mobile */
            .citation {
                min-width: 18px;
                height: 18px;
                font-size: 0.75em;
                padding: 0 5px;
            }
            
            /* Better reference grid on mobile */
            .reference-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .reference-tile {
                padding: 15px;
            }
            
            /* Main content adjustments */
            #main > .inner {
                padding: 20px 15px;
            }
            
            .container {
                padding: 1rem;
                margin: 1rem auto;
            }
            
            /* Improve Fancybox usability on mobile */
            .fancybox__button {
                width: 40px !important;
                height: 40px !important;
            }
            
            .fancybox__caption {
                font-size: 0.9em !important;
                padding: 8px 12px !important;
            }
        }
        
        @media screen and (max-width: 480px) {
            /* Further optimizations for very small screens */
            .waveform-section {
                padding: 15px 12px;
            }
            
            .waveform-section h2 {
                font-size: 1.3em;
            }
            
            .waveform-section h3 {
                font-size: 1.1em;
            }
            
            .waveform-section p, .image-tile .caption {
                font-size: 0.9em;
                line-height: 1.5;
            }
            
            /* Make menu items even larger for small touch screens */
            nav#menu ul li a {
                padding: 14px 0;
                font-size: 1.1em;
            }
            
            /* Fix image display on very small screens */
            .image-tile img {
                margin-bottom: 10px;
            }
            
            .citation {
                min-width: 16px;
                height: 16px;
                font-size: 0.7em;
                padding: 0 4px;
            }
            
            /* Stacked references on mobile */
            .reference-tile {
                padding: 12px;
            }
            
            .reference-title {
                font-size: 0.95em;
            }
            
            .reference-authors, .reference-journal {
                font-size: 0.85em;
            }
            
            /* Better Fancybox controls for tiny screens */
            .fancybox__button {
                width: 36px !important;
                height: 36px !important;
            }
            
            /* Remove hover effects on mobile */
            .waveform-section:hover,
            .image-tile:hover,
            .logo:hover,
            .sidebar-logo:hover,
            .reference-tile:hover {
                transform: none;
            }
        }
        
        /* Fix for menu closing on small screens */
        @media screen and (max-width: 736px) {
            #menu a.close {
                width: 44px;
                height: 44px;
                line-height: 44px;
                font-size: 1.25em;
            }
            
            #menu .inner {
                padding-top: 4.5em;
            }
        }
    </style>
</head>
<body class="is-preload">
    <!-- Wrapper -->
    <div id="wrapper">
        <header id="header">
            <div class="inner">
                <!-- Logo -->
                <a href="index.html" class="logo">
                    <span class="symbol"><img src="./images/VEXUS.ATLAS.png" alt="" /></span>
                    <span class="title">VExUS ATLAS</span>
                </a>
                
                <nav>
                    <ul>
                        <li><a href="#menu">Menu</a></li>
                    </ul>
                </nav>
            </div>
        </header>

        <!-- Sidebar Menu -->
        <nav id="menu">
            <div class="inner">
                <div class="logo-container">
                    <img src="./images/VEXUS.ATLAS.png" alt="VExUS ATLAS Logo" class="sidebar-logo">
                </div>
                <h2>Menu</h2>
                <ul>
                    <li><a href="index.html">Home</a></li>
                    <li><a href="education.html">VEXUS Overview</a></li>
                    <li><a href="waveform.html">Waveforms</a></li>
                    <li><a href="calculator.html">AI Image Recognition</a></li>
                    <li><a href="acquisition.html">Image Acquisition Guide</a></li>
                    <li><a href="Publications.html">Publications</a></li>
                    <li><a href="literature_review.html">Literature Review</a></li>
                    <li><a href="image_gallery.html">Image Gallery</a></li>
                    <li><a href="about.html">About VExUS ATLAS</a></li>
                    <li><a href="our_team.html">Our Team</a></li>
                    <li><a href="contact.html">Contact</a></li>
                </ul>
                <a href="#menu" class="close">✕</a>
            </div>
        </nav>

        <!-- Main Content -->
        <div id="main">
            <div class="inner">
                <div class="container">
                    <div class="logo-container">
                        <img src="./images/VEXUS.ATLAS.png" alt="VExUS ATLAS Logo" class="logo">
                    </div>
                    <div class="waveform-container">
                        <div class="education-header">
                            <h1>Interpreting VExUS Doppler Waveforms</h1>
                        </div>
                        
                        <div class="waveform-section">
                            <h2 style="text-align: center;">Introduction to VExUS and Venous Waveforms</h2>
                            <p>Venous Excess Ultrasound (VExUS) is a point-of-care ultrasound assessment method that evaluates systemic venous congestion by examining the Doppler waveforms of key veins (hepatic, portal, and intrarenal) alongside the size and variation of the inferior vena cava (IVC)<sup class="citation"><a href="#reference-1">1</a></sup><sup class="citation"><a href="#reference-2">2</a></sup>. By analyzing these venous patterns, clinicians can estimate how elevated right-sided heart pressures or excessive fluid loading affect organ blood flow<sup class="citation"><a href="#reference-1">1</a></sup><sup class="citation"><a href="#reference-3">3</a></sup>.</p>
                            
                            <p>Recognizing normal waveforms versus mild or severe abnormalities provides an immediate snapshot of venous congestion:</p>
                            <ul>
                                <li><strong>Normal waveforms</strong> suggest no significant congestion.</li>
                                <li><strong>Mild abnormalities</strong> indicate early or moderate venous hypertension.</li>
                                <li><strong>Severe abnormalities</strong> reflect high venous pressure and substantial backward flow.</li>
                            </ul>
                            <p>This resource will describe how to recognize these pattern changes in each vein type.</p>
                        </div>

                        <div class="waveform-section">
                            <h2 style="text-align: center;">EKG Tracing in VExUS Assessment</h2>
                            <p>Hepatic vein waveforms are best interpreted with respect to the cardiac cycle, making simultaneous EKG tracing invaluable for accurate pattern recognition and phase identification. The cardiac electrical events help identify the timing of various waveform components:</p>
                            
                            <a href="images/EKGtracing.hepatic.png" data-fancybox="waveform-gallery" data-caption="EKG Tracing with Hepatic Vein Waveform showing temporal correlation between electrical events and flow patterns" data-type="image">
                                <img src="images/EKGtracing.hepatic.png" alt="EKG Tracing with Hepatic Vein Waveform" class="waveform-image">
                            </a>
                            
                            <p>With EKG tracing, clinicians can precisely identify:</p>
                            <ul>
                                <li>The <strong>S wave</strong> occurring during ventricular systole (between QRS complex and T wave)</li>
                                <li>The <strong>D wave</strong> during early ventricular diastole (after T wave)</li>
                                <li>The <strong>A wave</strong> during atrial contraction (shortly after P wave)</li>
                                <li>The <strong>V wave</strong> at end-systole (during the T wave)</li>
                            </ul>
                            
                            <p>This temporal correlation helps identify waveform abnormalities with confidence, particularly when distinguishing between S and D waves in cases of mild congestion or determining true flow reversals in severe congestion.</p>
                        </div>

                        <div class="waveform-section">
                            <h2 style="text-align: center;">Hepatic Vein Waveforms</h2>
                            
                            <h3 style="text-align: center;">Normal Pattern</h3>
                            <ul>
                                <li><strong>"S > D":</strong> The systolic wave (S) is larger than the diastolic wave (D) when viewed on Doppler.</li>
                                <li>Includes small retrograde deflections: the A wave (atrial contraction) and a tiny V wave (end-systole).</li>
                                <li>Overall, flow is predominantly toward the heart during both systole and diastole, with only minor reversals in late diastole (A wave)<sup class="citation"><a href="#reference-4">4</a></sup>.</li>
                            </ul>
                            
                            <div class="image-tile">
                                <div class="title">Normal Hepatic Vein: Doppler ASVD Pattern</div>
                                <a href="images/hepaticvein.normal.asvd.png" data-fancybox="hepatic-gallery" data-caption="Doppler display of normal hepatic vein ASVD pattern. The clear wave components show optimal Doppler alignment with characteristic wave timing and amplitude relationships." data-type="image">
                                    <img src="images/hepaticvein.normal.asvd.png" alt="Doppler Normal Hepatic ASVD Pattern">
                                </a>
                                <div class="caption">
                                    Doppler display showing the characteristic ASVD pattern in optimal alignment. Each wave component is clearly defined: atrial contraction (A), systolic forward flow (S), venous (V), and diastolic (D) waves. The prominent S wave amplitude relative to D wave demonstrates normal right atrial pressures and preserved venous return dynamics.
                                </div>
                            </div>

                            <div class="image-tile">
                                <div class="title">Normal Hepatic Vein: ASVD View</div>
                                <a href="images/Hepatic.asvd.normal.2.png" data-fancybox="hepatic-gallery" data-caption="A view of normal hepatic vein ASVD pattern showing clear wave components. Note the prominent S wave and the characteristic A, V, and D waves in proper sequence." data-type="image">
                                    <img src="images/Hepatic.asvd.normal.2.png" alt="Normal Hepatic ASVD Pattern">
                                </a>
                                <div class="caption">
                                    A view of the normal hepatic vein waveform showing the classic ASVD pattern. This perspective highlights the wave components from a different angle, with clear visualization of the atrial contraction (A), systolic forward flow (S), venous (V), and diastolic (D) waves. The prominent S wave confirms normal right heart pressures.
                                </div>
                            </div>
                            
                            <h3 style="text-align: center;">Mild Congestion</h3>
                            <ul>
                                <li><strong>"S < D":</strong> The systolic wave is still below the baseline (forward) but smaller in amplitude compared to the diastolic wave.</li>
                                <li>The A wave (atrial reversal) becomes more pronounced; the V wave may also be noticeable.</li>
                                <li>Suggests rising right atrial pressure, but no full-flow reversal in systole yet<sup class="citation"><a href="#reference-5">5</a></sup><sup class="citation"><a href="#reference-6">6</a></sup>.</li>
                            </ul>
                            
                            <div class="image-tile">
                                <div class="title">Mild Congestion: S < D Pattern with AVSD Visible</div>
                                <a href="images/hepatic.mild.png" data-fancybox="hepatic-gallery" data-caption="Doppler display of mild hepatic congestion showing the S < D pattern. Note the pronounced A wave and visible V wave, with the systolic (S) wave amplitude smaller than the diastolic (D) wave.">
                                    <img src="images/hepatic.mild.png" alt="Doppler Mild Hepatic Congestion Pattern">
                                </a>
                                <div class="caption">
                                    This image demonstrates mild hepatic vein congestion with the classic "S < D" pattern. Note how the systolic (S) wave amplitude is smaller than the diastolic (D) wave, while both remain below the baseline (forward flow). The atrial (A) wave is more pronounced, and all components of the AVSD pattern are visible. This pattern indicates early venous congestion with rising right atrial pressures.
                                </div>
                            </div>
                            
                            <h3 style="text-align: center;">Severe Congestion</h3>
                            <ul>
                                <li><strong>Reversed S Wave:</strong> Now the S wave is above the baseline, indicating backward flow into the liver during systole.</li>
                                <li>Only the D wave remains antegrade. The A (and sometimes V) waves become markedly elevated.</li>
                                <li>Reflects significantly elevated right atrial pressures, often seen in severe tricuspid regurgitation or right-sided heart failure<sup class="citation"><a href="#reference-2">2</a></sup><sup class="citation"><a href="#reference-5">5</a></sup>.</li>
                            </ul>
                            
                            <div class="image-tile">
                                <div class="title">Hepatic Vein S-D Reversal</div>
                                <a href="images/Hepatic.SR.SD.png" data-fancybox="waveform-gallery" data-caption="Severe systolic flow reversal in a hepatic vein, showing S wave above baseline (retrograde flow) and D wave below baseline (antegrade flow)">
                                    <img src="images/Hepatic.SR.SD.png" alt="Hepatic Vein S-D Reversal Waveform">
                                </a>
                                <div class="caption">
                                    This image demonstrates severe systolic flow reversal in a hepatic vein. Note how the S wave appears above the baseline (retrograde flow during systole) while the D wave remains below the baseline (antegrade flow during diastole). This pattern indicates significant right-sided venous congestion and is often associated with elevated right atrial pressures.
                                </div>
                            </div>
                        </div>

                        <div class="waveform-section">
                            <h2>Portal Vein Waveforms</h2>
                            
                            <h3>Normal Pattern</h3>
                            <ul>
                                <li><strong>Continuous Monophasic Flow:</strong> In healthy states, the portal vein shows essentially steady forward flow (hepatopetal), with minimal respiratory or cardiac pulsatility.</li>
                                <li>Pulsatility fraction < 30% (little variation in velocity over the cardiac cycle)<a href="#reference-3" class="citation">3</a><a href="#reference-7" class="citation">7</a>.</li>
                            </ul>
                            
                            <div class="image-tile">
                                <div class="title">Portal Vein Normal Flow</div>
                                <a href="images/portal.normal.png" data-fancybox="portal-gallery" data-caption="Normal portal vein waveform showing continuous monophasic flow with minimal pulsatility, indicating normal venous hemodynamics." data-type="image">
                                    <img src="images/portal.normal.png" alt="Portal Vein Normal Flow">
                                </a>
                                <div class="caption">
                                    This Doppler image demonstrates normal portal vein flow. The waveform shows continuous, monophasic forward flow with minimal variation throughout the cardiac cycle. This steady pattern with a pulsatility fraction below 30% indicates normal portal venous hemodynamics without significant influence from cardiac activity or venous congestion.
                                </div>
                            </div>
                            
                            <h3>Mild Congestion</h3>
                            <ul>
                                <li><strong>Mildly Pulsatile Flow:</strong> A noticeable undulation in velocity emerges, yielding a 30–50% pulsatility index.</li>
                                <li>Forward flow is preserved (no reversal), but the waveform starts dipping and peaking in sync with cardiac activity<a href="#reference-2" class="citation">2</a><a href="#reference-3" class="citation">3</a>.</li>
                            </ul>
                            
                            <div class="image-tile">
                                <div class="title">Portal Vein Mild Congestion</div>
                                <a href="images/portal.mild.png" data-fancybox="portal-gallery" data-caption="Portal vein showing mild congestion with pulsatile flow pattern. Note the visible undulations in velocity that correspond to cardiac cycle without dropping below baseline." data-type="image">
                                    <img src="images/portal.mild.png" alt="Portal Vein Mild Congestion">
                                </a>
                                <div class="caption">
                                    This Doppler image demonstrates mild portal vein congestion. Note the characteristic undulating waveform with a pulsatility index between 30-50%. The flow velocity varies throughout the cardiac cycle but remains consistently forward (below baseline), indicating early venous congestion without reversal of flow. This pattern suggests the beginning of backward transmission of right atrial pressure through the hepatic circulation.
                                </div>
                            </div>
                            
                            <h3>Severe Congestion</h3>
                            <ul>
                                <li><strong>High Pulsatility > 50%:</strong> Marked oscillation of the portal flow with deep troughs.</li>
                                <li>Can approach or briefly cross the baseline (or show short-lived flow reversal), reflecting high venous pressures transmitted back from the right atrium and hepatic circulation<a href="#reference-3" class="citation">3</a><a href="#reference-6" class="citation">6</a>.</li>
                            </ul>
                            
                            <div class="image-tile">
                                <div class="title">Portal Vein Severe Congestion</div>
                                <a href="images/portal.severe.png" data-fancybox="portal-gallery" data-caption="Portal vein with severe congestion showing marked pulsatility with deep troughs approaching or briefly crossing the baseline, indicating significant venous hypertension." data-type="image">
                                    <img src="images/portal.severe.png" alt="Portal Vein Severe Congestion">
                                </a>
                                <div class="caption">
                                    This image shows severe portal vein congestion with a pulsatility index exceeding 50%. The marked oscillations feature deep troughs that approach or briefly cross the baseline, indicating significant backpressure from the right heart and hepatic circulation. This degree of pulsatility is associated with significant venous hypertension and organ congestion.
                                </div>
                            </div>
                        </div>

                        <div class="waveform-section">
                            <h2>Intrarenal (Renal Parenchymal) Vein Waveforms</h2>
                            
                            <h3>Normal Pattern</h3>
                            <ul>
                                <li><strong>Continuous Monophasic Flow:</strong> The tiny interlobar veins in the kidney typically exhibit a steady, non-pulsatile flow throughout the cardiac cycle<sup class="citation"><a href="#reference-7">7</a></sup>.</li>
                                <li>No distinct systolic or diastolic components are recognizable; wave appears almost flat on Doppler.</li>
                            </ul>
                            
                            <div class="image-tile">
                                <div class="title">Normal Renal Vein Waveform</div>
                                <a href="images/renal.normal.png" data-fancybox="renal-gallery" data-caption="Normal renal vein waveform showing characteristic continuous monophasic flow pattern with minimal pulsatility." data-type="image">
                                    <img src="images/renal.normal.png" alt="Normal Renal Vein Waveform">
                                </a>
                                <div class="caption">
                                    This Doppler image demonstrates a normal renal vein waveform pattern. Note the continuous, monophasic flow with minimal variation throughout the cardiac cycle. This flat, steady pattern indicates normal venous drainage from the kidney without significant right-sided pressure influence. The absence of pulsatility suggests normal central venous pressure.
                                </div>
                            </div>
                            
                            <h3>Mild Congestion</h3>
                            <ul>
                                <li><strong>Biphasic (S & D) Pulsatile Flow:</strong> As venous pressure rises, a waveform emerges with two forward-flow peaks—one in systole and another in diastole—separated by a brief trough.</li>
                                <li>Called a "discontinuous" pattern, it reflects moderate venous congestion within the renal parenchyma<a href="#reference-1" class="citation">1</a><a href="#reference-5" class="citation">5</a>.</li>
                            </ul>
                            
                            <div class="image-tile">
                                <div class="title">Renal Vein Mild Congestion</div>
                                <a href="images/Renal.mild.png" data-fancybox="renal-gallery" data-caption="Renal vein with mild congestion showing the characteristic biphasic (S & D) pulsatile flow pattern with two distinct forward-flow peaks separated by a trough. Note the renal artery waveform on top and discontinuous venous pattern below." data-type="image">
                                    <img src="images/Renal.mild.png" alt="Renal Vein Mild Congestion">
                                </a>
                                <div class="caption">
                                    This image demonstrates mild renal vein congestion with the characteristic biphasic pattern. Note the renal artery waveform visible at the top of the image, and below it, the discontinuous venous S and D waves. The two distinct forward-flow peaks (systolic and diastolic) are separated by a noticeable trough in the venous waveform. This "discontinuous" flow pattern indicates moderate venous congestion in the renal parenchyma with early transmission of central venous pressure variations to the kidney's venous circulation.
                                </div>
                            </div>
                            
                            <h3>Severe Congestion</h3>
                            <ul>
                                <li><strong>Monophasic D-Only Flow:</strong> The systolic component disappears entirely, and only diastolic flow remains visible per heartbeat.</li>
                                <li>Signifies significant back-pressure on the kidney's venous outflow. This pattern correlates with higher risk of acute kidney injury<a href="#reference-1" class="citation">1</a><a href="#reference-8" class="citation">8</a>.</li>
                            </ul>
                            
                            <div class="image-tile">
                                <div class="title">Renal Vein Severe Congestion</div>
                                <a href="images/renal.severe.png" data-fancybox="renal-gallery" data-caption="Renal vein with severe congestion showing the characteristic monophasic D-only flow pattern. Note the absence of systolic flow component, indicating significant venous hypertension." data-type="image">
                                    <img src="images/renal.severe.png" alt="Renal Vein Severe Congestion">
                                </a>
                                <div class="caption">
                                    This Doppler image demonstrates severe renal vein congestion with the characteristic monophasic D-only flow pattern. Note the complete absence of the systolic flow component, with flow only occurring during diastole. This pattern indicates significant back-pressure on renal venous outflow and is associated with increased risk of acute kidney injury in the setting of venous congestion.
                                </div>
                            </div>
                        </div>

                        <div class="waveform-section">
                            <h2>Putting It All Together: VExUS Grading</h2>
                            
                            <a href="images/VExUS.grading.png" data-fancybox="waveform-gallery" data-caption="VExUS Grading System showing progression from normal to severe congestion patterns">
                                <img src="images/VExUS.grading.png" alt="VExUS Grading System" class="waveform-image">
                            </a>
                            
                            <ul>
                                <li><strong>Grade 0 (Normal):</strong> All hepatic, portal, and renal waveforms are normal, with a collapsible IVC.</li>
                                <li><strong>Grade 1 (Mild):</strong> One or more veins show mild abnormalities (e.g., S < D in hepatic vein, mild pulsatility in portal vein, or biphasic renal flow) combined with a dilated or non-collapsing IVC.</li>
                                <li><strong>Grade 2 (Moderate):</strong> At least one severe abnormality (e.g., reversed S wave in hepatic vein, marked pulsatility or brief reversal in portal vein, or D-only renal flow).</li>
                                <li><strong>Grade 3 (Severe):</strong> Two or more severe waveform changes across hepatic, portal, or renal veins.</li>
                            </ul>
                            
                            <p>Patients with advanced VExUS grades are at higher risk for congestive organ injury (hepatic congestion, kidney injury, etc.), and recognition of these patterns prompts intensified decongestive therapies<a href="#reference-1" class="citation">1</a><a href="#reference-2" class="citation">2</a><a href="#reference-8" class="citation">8</a>.</p>
                        </div>

                        <div class="waveform-section">
                            <h2>References</h2>
                            <div class="reference-grid">
                                <div class="reference-tile">
                                    <div class="reference-number">1</div>
                                    <div class="reference-title">The Venous Excess Ultrasound Grading System (VExUS) in Predicting AKI in Cardiac Surgery Patients</div>
                                    <div class="reference-authors">Beaubien-Souligny W, et al.</div>
                                    <div class="reference-journal">Crit Care Med. 2021;49(3):e263-e272</div>
                                    <a href="https://journals.lww.com/ccmjournal/Fulltext/2021/03000/The_Venous_Excess_Ultrasound_Grading_System.6.aspx" class="reference-link" target="_blank">View Article</a>
                                </div>

                                <div class="reference-tile">
                                    <div class="reference-number">2</div>
                                    <div class="reference-title">Focused Ultrasound Evaluation in Acute Medicine</div>
                                    <div class="reference-authors">Beaubien-Souligny W, et al.</div>
                                    <div class="reference-journal">J Am Heart Assoc. 2020;9:e014974</div>
                                    <a href="https://www.ahajournals.org/doi/10.1161/JAHA.119.014974" class="reference-link" target="_blank">View Article</a>
                                </div>

                                <div class="reference-tile">
                                    <div class="reference-number">3</div>
                                    <div class="reference-title">Clinical Significance of Portal Flow Pulsatility</div>
                                    <div class="reference-authors">Denault AY, et al.</div>
                                    <div class="reference-journal">J Cardiothorac Vasc Anesth. 2022;36(3):874-883</div>
                                    <a href="https://www.sciencedirect.com/science/article/pii/S1053077021005960" class="reference-link" target="_blank">View Article</a>
                                </div>

                                <div class="reference-tile">
                                    <div class="reference-number">4</div>
                                    <div class="reference-title">Guidelines for Performing a Comprehensive Transthoracic Echocardiographic Examination in Adults</div>
                                    <div class="reference-authors">Mitchell C, et al.</div>
                                    <div class="reference-journal">J Am Soc Echocardiogr. 2019;32(1):1-64</div>
                                    <a href="https://www.onlinejase.com/article/S0894-7317(18)30760-5/fulltext" class="reference-link" target="_blank">View Article</a>
                                </div>

                                <div class="reference-tile">
                                    <div class="reference-number">5</div>
                                    <div class="reference-title">Evaluation of organ congestion in heart failure</div>
                                    <div class="reference-authors">Mullens W, et al.</div>
                                    <div class="reference-journal">J Am Coll Cardiol. 2023;81(8):821-836</div>
                                    <a href="https://www.jacc.org/doi/10.1016/j.jacc.2022.11.078" class="reference-link" target="_blank">View Article</a>
                                </div>

                                <div class="reference-tile">
                                    <div class="reference-number">6</div>
                                    <div class="reference-title">Early Detection of Fluid Overload and Elevated Venous Pressure</div>
                                    <div class="reference-authors">Ait-Oufella H, et al.</div>
                                    <div class="reference-journal">Crit Care. 2019;23(1):176</div>
                                    <a href="https://ccforum.biomedcentral.com/articles/10.1186/s13054-019-2443-7" class="reference-link" target="_blank">View Article</a>
                                </div>

                                <div class="reference-tile">
                                    <div class="reference-number">7</div>
                                    <div class="reference-title">Renal Doppler Ultrasonography in the Critical Care Setting</div>
                                    <div class="reference-authors">Sobczyk D, Nycz K</div>
                                    <div class="reference-journal">Crit Care Res Pract. 2020;2020:8858794</div>
                                    <a href="https://www.hindawi.com/journals/ccrp/2020/8858794/" class="reference-link" target="_blank">View Article</a>
                                </div>

                                <div class="reference-tile">
                                    <div class="reference-number">8</div>
                                    <div class="reference-title">A Stepwise Demonstration of the VExUS Score</div>
                                    <div class="reference-authors">Sorouri K, et al.</div>
                                    <div class="reference-journal">J Cardiothorac Vasc Anesth. 2022;36(4):1163-1171</div>
                                    <a href="https://www.sciencedirect.com/science/article/pii/S1053077021008502" class="reference-link" target="_blank">View Article</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="html5up-phantom/assets/js/jquery.min.js"></script>
    <script src="html5up-phantom/assets/js/browser.min.js"></script>
    <script src="html5up-phantom/assets/js/breakpoints.min.js"></script>
    <script src="html5up-phantom/assets/js/util.js"></script>
    <script src="html5up-phantom/assets/js/main.js"></script>
    <!-- Fancybox JS -->
    <script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0/dist/fancybox/fancybox.umd.js"></script>
    
    <script>
        // Simplified Fancybox initialization for version 5.0
        document.addEventListener('DOMContentLoaded', function() {
            console.log("Initializing Fancybox...");
            
            // Define a simpler initialization function
            function initFancybox() {
                try {
                    if (typeof Fancybox !== 'undefined') {
                        Fancybox.bind('[data-fancybox]', {
                            // Use the correct API: https://fancyapps.com/docs/ui/fancybox/options
                            // Simplified config that should work with v5.0
                            compact: false,
                            idle: false,
                            animated: false,
                            showClass: false,
                            hideClass: false,
                            dragToClose: false,
                            contentClick: "iterateZoom",
                            Images: {
                                zoom: true,
                            },
                            Toolbar: {
                                display: {
                                    left: ["infobar"],
                                    middle: [],
                                    right: ["iterateZoom", "close"],
                                },
                                items: {
                                    iterateZoom: {
                                        tpl: '<button class="f-button" title="Zoom in/out" data-fancybox-iterateZoom><svg><circle cx="10" cy="10" r="6"></circle></svg></button>'
                                    }
                                }
                            },
                            closeButton: "top",
                            template: {
                                // Plain template for better compatibility
                                closeButton: '<button data-fancybox-close class="f-button" title="Close"><svg><path d="M10 8.586L5.879 4.464 4.464 5.88 8.586 10l-4.122 4.121 1.415 1.415L10 11.414l4.121 4.122 1.415-1.415L11.414 10l4.122-4.121-1.415-1.415L10 8.586z"></path></svg></button>',
                            }
                        });
                        
                        console.log("Fancybox initialized with simple config");
                    } else {
                        console.error("Fancybox not found");
                    }
                } catch (err) {
                    console.error("Fancybox error:", err);
                }
            }
            
            // Try to initialize immediately
            initFancybox();
            
            // Also try with a slight delay to ensure DOM is fully ready
            setTimeout(initFancybox, 500);
            
            // Direct click handlers as fallback
            document.querySelectorAll('a[data-fancybox]').forEach(function(link) {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    var imgSrc = this.getAttribute('href');
                    var caption = this.getAttribute('data-caption') || '';
                    var galleryName = this.getAttribute('data-fancybox');
                    
                    console.log("Manual click on gallery item:", imgSrc, "Gallery:", galleryName);
                    
                    // Collect all images from the same gallery
                    var galleryItems = [];
                    if (galleryName) {
                        document.querySelectorAll('a[data-fancybox="' + galleryName + '"]').forEach(function(item) {
                            galleryItems.push({
                                src: item.getAttribute('href'),
                                caption: item.getAttribute('data-caption') || '',
                                type: 'image'
                            });
                        });
                    } else {
                        galleryItems.push({
                            src: imgSrc,
                            caption: caption,
                            type: 'image'
                        });
                    }
                    
                    // Try to open with Fancybox
                    try {
                        if (typeof Fancybox !== 'undefined') {
                            Fancybox.show(galleryItems, {
                                startIndex: galleryItems.findIndex(item => item.src === imgSrc)
                            });
                        } else {
                            // Fallback: open image in new tab
                            window.open(imgSrc, '_blank');
                        }
                    } catch (err) {
                        console.error("Error showing image:", err);
                        window.open(imgSrc, '_blank');
                    }
                });
            });
        });
        
        // Function to initialize menu toggle
        function initializeMenuToggle() {
            console.log("Initializing menu toggle");
            
            try {
                // Get menu elements
                const menuToggle = document.querySelector('a[href="#menu"]');
                const menu = document.getElementById('menu');
                
                if (!menuToggle || !menu) {
                    console.error("Menu elements not found!");
                    return;
                }
                
                // Track transition state
                let isMenuTransitioning = false;
                
                // First ensure menu is properly hidden
                document.body.classList.remove('is-menu-visible');
                menu.classList.remove('visible', 'active');
                
                // Remove existing click handlers
                const newMenuToggle = menuToggle.cloneNode(true);
                menuToggle.parentNode.replaceChild(newMenuToggle, menuToggle);
                
                // Add click handler
                newMenuToggle.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    
                    if (isMenuTransitioning) return;
                    isMenuTransitioning = true;
                    
                    requestAnimationFrame(() => {
                        document.body.classList.add('is-menu-visible');
                        menu.style.display = 'block';
                        
                        void menu.offsetWidth;
                        
                        menu.classList.add('visible', 'active');
                        
                        setTimeout(() => {
                            isMenuTransitioning = false;
                        }, 300);
                    });
                });
                
                // Function to hide menu
                function hideMenu() {
                    if (isMenuTransitioning) return;
                    isMenuTransitioning = true;
                    
                    requestAnimationFrame(() => {
                        document.body.classList.remove('is-menu-visible');
                        menu.classList.remove('visible', 'active');
                        
                        setTimeout(() => {
                            menu.style.display = 'none';
                            isMenuTransitioning = false;
                        }, 300);
                    });
                }
                
                // Handle close button
                const closeButton = menu.querySelector('a.close');
                if (closeButton) {
                    const newCloseButton = closeButton.cloneNode(true);
                    closeButton.parentNode.replaceChild(newCloseButton, closeButton);
                    
                    newCloseButton.addEventListener('click', function(e) {
                        e.preventDefault();
                        e.stopPropagation();
                        hideMenu();
                    });
                }
                
                // Handle clicks outside menu
                document.body.addEventListener('click', function(e) {
                    if (!e.target.closest('#menu') && !e.target.closest('a[href="#menu"]')) {
                        hideMenu();
                    }
                });
                
                // Handle escape key
                document.addEventListener('keydown', function(e) {
                    if (e.key === 'Escape' || e.keyCode === 27) {
                        hideMenu();
                    }
                });
                
                console.log("Menu toggle initialization complete");
            } catch (error) {
                console.error("Error initializing menu toggle:", error);
            }
        }
        
        // Initialize after DOM load
        document.addEventListener('DOMContentLoaded', function() {
            console.log("DOM loaded, initializing menu toggle");
            setTimeout(initializeMenuToggle, 100);
        });
        
        // Fallback initialization
        if (document.readyState === 'complete' || document.readyState === 'interactive') {
            console.log("Document already loaded, running fallback initialization");
            setTimeout(initializeMenuToggle, 200);
        }

        // Add scroll behavior for header
        document.addEventListener('DOMContentLoaded', function() {
            let lastScroll = 0;
            const header = document.getElementById('header');
            
            window.addEventListener('scroll', () => {
                const currentScroll = window.pageYOffset;
                
                if (currentScroll <= 0) {
                    header.classList.remove('hide');
                    return;
                }
                
                if (currentScroll > lastScroll && !header.classList.contains('hide')) {
                    // Scrolling down & header is visible
                    header.classList.add('hide');
                } else if (currentScroll < lastScroll && header.classList.contains('hide')) {
                    // Scrolling up & header is hidden
                    header.classList.remove('hide');
                }
                
                lastScroll = currentScroll;
            });
        });

        // Add extra Fancybox preload
        window.addEventListener('load', function() {
            // Find all gallery images
            const galleryImages = document.querySelectorAll('a[data-fancybox]');
            
            // Preload each image
            galleryImages.forEach(function(link) {
                const img = new Image();
                img.src = link.getAttribute('href');
                img.style.display = 'none';
                document.body.appendChild(img);
                
                setTimeout(function() {
                    document.body.removeChild(img);
                }, 5000);
            });
            
            console.log('Gallery images preloaded for Fancybox');
        });
    </script>
</body>
</html> 